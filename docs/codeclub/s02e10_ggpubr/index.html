<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.0.0-beta.3 for Hugo" />
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jelmer Poelstra" />

  
  
  
    
  
  <meta name="description" content="In this session, we will be exploring one of the most powerful ggplot extensions, ggpubr. We will take a look at how to add statistical results to a comparison plot." />

  
  <link rel="alternate" hreflang="en-us" href="https://biodash.github.io/codeclub/s02e10_ggpubr/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#3f51b5" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.80f9a276c6100914c616a06e45ba8d09.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F9CQ7P0DX"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-9F9CQ7P0DX', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="https://biodash.github.io/codeclub/s02e10_ggpubr/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="BioDASH" />
  <meta property="og:url" content="https://biodash.github.io/codeclub/s02e10_ggpubr/" />
  <meta property="og:title" content="Code Club S02E10: An introduction to ggpubr | BioDASH" />
  <meta property="og:description" content="In this session, we will be exploring one of the most powerful ggplot extensions, ggpubr. We will take a look at how to add statistical results to a comparison plot." /><meta property="og:image" content="https://biodash.github.io/media/logo_hu6407506e646a281542ecb299640680ce_37988_300x300_fit_lanczos_2.png" />
    <meta property="twitter:image" content="https://biodash.github.io/media/logo_hu6407506e646a281542ecb299640680ce_37988_300x300_fit_lanczos_2.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-11-03T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-11-03T11:03:08-04:00">
  

  



  

  

  <link rel='stylesheet' href='/css/highlight-light.css' title='hl-light'>
<link rel='stylesheet' href='/css/highlight-dark.css' title='hl-dark' disabled>



  <title>Code Club S02E10: An introduction to ggpubr | BioDASH</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="20d4cc04e71352036bd538c40794fe7b" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7a224883d792570fd34d30c7134eace3.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Code Club</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/codeclub-schedule/"><span>- <b>Schedule</b></span></a>
            
              <a class="dropdown-item" href="/codeclub/"><span>- Past Sessions</span></a>
            
              <a class="dropdown-item" href="/codeclub-setup/"><span>- Computer Setup</span></a>
            
              <a class="dropdown-item" href="/"><span>------------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-suggest/"><span>- Suggest a Topic</span></a>
            
              <a class="dropdown-item" href="/codeclub-present/"><span>- Info for Presenters</span></a>
            
              <a class="dropdown-item" href="/"><span>-----------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-about/"><span>- <b>About Code Club & Join Us!</b></span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/events/"><span>Other Events</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Tutorials & Materials</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/material/"><span><b>Overview</b></span></a>
            
              <a class="dropdown-item" href="/"><span>---------------------</span></a>
            
              <a class="dropdown-item" href="/tutorials/r-resources-tips/"><span>- R Resources and Tips</span></a>
            
              <a class="dropdown-item" href="/"><span>--------------------</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/2020-12-microbiomics-workshop/"><span>- Metabarcoding workshop (Fall '20)</span></a>
            
              <a class="dropdown-item" href="/tutorials/2021-01_rnaseq/"><span>- RNA-seq intro meetings (Spring '21)</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/pracs-sp21/"><span>- Computing Course (Spring '21)</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/support/"><span>Need Support?</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://github.com/biodash/biodash.github.io" target="_blank" rel="noopener"><i class='fab fa-github'></i><span></span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/index.xml" target="_blank" rel="noopener"><i class='fas fa-rss'></i><span></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      
        
      
        
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    
<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
        <div class="d-none d-xl-block col-xl-2 docs-toc">
            <ul class="nav toc-top">
                <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
            </ul>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#understand-what-is-a-ggplot-extension">Understand what is a <em>ggplot</em> extension</a></li>
    <li><a href="#define-what-is-ggpubr">Define what is <em>ggpubr</em></a></li>
    <li><a href="#getting-everything-ready">Getting everything ready</a>
      <ul>
        <li><a href="#loading-all-required-packages">Loading all required packages</a></li>
        <li><a href="#remembering-the-palmer-penguins-data">Remembering the palmer penguins data</a></li>
        <li><a href="#creating-the-plot-with-ggplot">Creating the plot with ggplot</a></li>
      </ul>
    </li>
    <li><a href="#add-statistical-results-to-the-density-plot">Add statistical results to the density plot</a>
      <ul>
        <li><a href="#checking-assumptions">Checking assumptions</a></li>
        <li><a href="#exploring-the-stat_compare_means-function">Exploring the <code>stat_compare_means()</code> function</a></li>
        <li><a href="#using-ggplot-to-recreate-the-plot">Using <em>ggplot</em> to recreate the plot</a></li>
        <li><a href="#breakout-rooms-i-10-min">Breakout Rooms I (10 min)</a></li>
        <li><a href="#exercise-1">Exercise 1</a></li>
        <li><a href="#multiple-group-comparison-within-a-variable">Multiple group comparison within a variable</a></li>
        <li><a href="#breakout-rooms-ii-10-min">Breakout Rooms II (10 min)</a></li>
        <li><a href="#exercise-2">Exercise 2</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        <main class="col-12 col-md-0 col-xl-10 py-md-3 pl-md-5 docs-content" role="main">
            

            <article class="article">

                












  

  
  
  
<div class="article-container pt-3">
  <h1>Code Club S02E10: An introduction to ggpubr</h1>

  

  
    



<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      <a href="/authors/daniel-quiroz/">Daniel Quiroz</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
    Nov 3, 2021
  </span>
  

  

  

  
  
  
  
  

  
  

</div>

    





  
</div>



                <div class="article-container">
                    <div class="article-style">
                        <br>
<h1 id="learning-objectives">Learning objectives</h1>
<blockquote>
<ul>
<li>Understand what is a <em>ggplot</em> extension</li>
<li>Define what is <em>ggpubr</em></li>
<li>Recognize the advantages and drawback of <em>ggpubr</em></li>
<li>Create a density plot with <em>ggpubr</em></li>
<li>Add statistical results to density plots</li>
</ul>
</blockquote>
<br>
<hr>
<h2 id="understand-what-is-a-ggplot-extension">Understand what is a <em>ggplot</em> extension</h2>
<p>A <em>ggplot</em> extension is a set of functions that helps in the automation of a given task. In the case of <em>ggplot</em> extensions, there are 102 registered extensions up today.</p>
<p><em>ggplot</em>&rsquo;s extensions are developed based on the core of <em>ggplot</em> and help to create a customized plot with certain features such as animation, specific color scales, or to produce a ready to publish figure.</p>
<p>The <a href="https://exts.ggplot2.tidyverse.org/" target="_blank" rel="noopener"><em>ggplot</em> extensions website</a> has an overview of the available extensions:</p>
<div class="highlight">
<iframe src="https://exts.ggplot2.tidyverse.org/gallery/" width="100%" height="400px" data-external="1">
</iframe>
</div>
<br>
<hr>
<h2 id="define-what-is-ggpubr">Define what is <em>ggpubr</em></h2>
<p><em>ggpubr</em> is an R package that produces ggplot-based plots with a more elegant aesthetic. Although <em>ggpubr</em> has default figures themes, plots usually require some formatting before sending them for publication.</p>
<br>
<hr>
<h2 id="getting-everything-ready">Getting everything ready</h2>
<p>First, we can take a look at the data that we are going to use. In this case, since we are already familiar with <em>palmerpenguins</em> dataset, we are going to continue using this data.</p>
<p>To remember the data structure, we can use the <code>glimpse</code> function.</p>
<div class="alert alert-warning">
<div>
<p>If you do not have installed the palmergenguins library, you can do it with this line. If you already have it, skip this line.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='o'>(</span><span class='s'>"palmerpenguins"</span><span class='o'>)</span></code></pre>
</div>
<p>To install the ggpubr package for the first time, you can use this command.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='o'>(</span><span class='s'>"ggpubr"</span><span class='o'>)</span></code></pre>
</div>
</div>
</div>
<hr>
<h3 id="loading-all-required-packages">Loading all required packages</h3>
<div class="alert alert-note">
<div>
<p>A good programming style is to load all necessary packages at the very beginning of the script.</p>
</div>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='o'>)</span>      <span class='c'># To load all packages including in the tidyverse</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://allisonhorst.github.io/palmerpenguins/'>palmerpenguins</a></span><span class='o'>)</span> <span class='c'># Load the example data</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='o'>)</span>         <span class='c'># Create ready to publish figures</span></code></pre>
</div>
<h3 id="remembering-the-palmer-penguins-data">Remembering the palmer penguins data</h3>
<p><img src="./culmen_depth.png" alt=""></p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>glimpse</span><span class='o'>(</span><span class='nv'>penguins</span><span class='o'>)</span>
<span class='c'>#&gt; Rows: 344</span>
<span class='c'>#&gt; Columns: 8</span>
<span class='c'>#&gt; $ species           <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…</span>
<span class='c'>#&gt; $ island            <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…</span>
<span class='c'>#&gt; $ bill_length_mm    <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …</span>
<span class='c'>#&gt; $ bill_depth_mm     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …</span>
<span class='c'>#&gt; $ flipper_length_mm <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…</span>
<span class='c'>#&gt; $ body_mass_g       <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …</span>
<span class='c'>#&gt; $ sex               <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> male, female, female, NA, female, male, female, male…</span>
<span class='c'>#&gt; $ year              <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</span></code></pre>
</div>
<p>For the downstream example, we are going to contrast the bill depth of the female vs male penguins of the Adelie species found on the island of Biscoe.</p>
<p>Therefore, we need to filter based on <code>species == Adelie</code> and <code>island == Biscoe</code>.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Filter by species and island</span>
<span class='nv'>penguins_filtered</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'>%&gt;%</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>species</span> <span class='o'>==</span> <span class='s'>"Adelie"</span>, <span class='nv'>island</span> <span class='o'>==</span> <span class='s'>"Biscoe"</span><span class='o'>)</span>

<span class='c'># Count the occurence of the factors levels of sex, species and island</span>
<span class='nv'>penguins_filtered</span> <span class='o'>%&gt;%</span> <span class='nf'>count</span><span class='o'>(</span><span class='nv'>sex</span>, <span class='nv'>species</span>, <span class='nv'>island</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 2 × 4</span></span>
<span class='c'>#&gt;   sex    species island     n</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> female Adelie  Biscoe    22</span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> male   Adelie  Biscoe    22</span></code></pre>
</div>
<h3 id="creating-the-plot-with-ggplot">Creating the plot with ggplot</h3>
<p>One of the main differences between <em>ggplot</em> and <em>ggpubr</em> is the syntax to create the base plot. In the case of <em>ggplot</em>, it is a layer based syntax, while in <em>ggpubr</em>, the syntax is embedded in a single function.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span><span class='nv'>penguins_filtered</span>,
       <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>sex</span>, y <span class='o'>=</span> <span class='nv'>bill_depth_mm</span>, fill <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_boxplot</span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-7-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>Now, since <em>ggpubr</em> has its own built-in geoms, we can use the <a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html" target="_blank" rel="noopener"><code>ggboxplot()</code></a> function:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>base_plot</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html'>ggboxplot</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins_filtered</span>,
                       x <span class='o'>=</span> <span class='s'>"sex"</span>,
                       y <span class='o'>=</span> <span class='s'>"bill_depth_mm"</span>,
                       fill <span class='o'>=</span> <span class='s'>"sex"</span><span class='o'>)</span>

<span class='nv'>base_plot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-8-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="alert alert-note">
<div>
<p>Since <em>ggpubr</em> creates plots based on <em>ggplot</em> syntax, you can treat these plots as another <em>ggplot</em> figure and use the same functions that you would use to format base <em>ggplot</em> plots.</p>
</div>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>base_plot</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html'>ggboxplot</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins_filtered</span>,
                       x <span class='o'>=</span> <span class='s'>"sex"</span>,
                       y <span class='o'>=</span> <span class='s'>"bill_depth_mm"</span>,
                       fill <span class='o'>=</span> <span class='s'>"sex"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>labs</span><span class='o'>(</span>title <span class='o'>=</span> <span class='s'>"Comparison between Adelie penguins by sex"</span>,
       fill <span class='o'>=</span> <span class='s'>"Sex:"</span>,
       x <span class='o'>=</span> <span class='s'>"Sex"</span>,
       y <span class='o'>=</span> <span class='s'>"Bill depth (mm)"</span><span class='o'>)</span>

<span class='nv'>base_plot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-9-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<br>
<hr>
<h2 id="add-statistical-results-to-the-density-plot">Add statistical results to the density plot</h2>
<p>When hypotheses testing is brought to the table, we need to consider which type of stats we can and cannot apply to our data. Briefly, if our data fits the assumptions of being normally distributed and having variance homogeneity, we can apply parametric tests. On the other hand, if our data does not fit the assumptions, we need to apply a nonparametric test to the data.</p>
<table>
<thead>
<tr>
<th>Comparison</th>
<th>Parametric</th>
<th>Nonparametric</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>2 groups</strong></td>
<td>t-test</td>
<td>Wilcoxon test</td>
</tr>
<tr>
<td><strong>&gt;2 groups</strong></td>
<td>one-way anova</td>
<td>Krustal-Wallis test</td>
</tr>
</tbody>
</table>
<h3 id="checking-assumptions">Checking assumptions</h3>
<p>If we would like to conduct a hypotheses test, we need first to check assumptions (homogeneity of variance and and normality):</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/stats/bartlett.test.html'>bartlett.test</a></span><span class='o'>(</span><span class='nv'>bill_depth_mm</span> <span class='o'>~</span> <span class='nv'>sex</span>, data <span class='o'>=</span> <span class='nv'>penguins_filtered</span><span class='o'>)</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;   Bartlett test of homogeneity of variances</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; data:  bill_depth_mm by sex</span>
<span class='c'>#&gt; Bartlett's K-squared = 0.94576, df = 1, p-value = 0.3308</span></code></pre>
</div>
<h3 id="exploring-the-stat_compare_means-function">Exploring the <code>stat_compare_means()</code> function</h3>
<p>We can use the function <a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html" target="_blank" rel="noopener"><code>stat_compare_means()</code></a> to annotate the plot with the results of a statistical test comparing group means:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>base_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-11-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>In order to be 100% sure about the computed p-value, we can compute the Wilcoxon test in the console:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/stats/wilcox.test.html'>wilcox.test</a></span><span class='o'>(</span><span class='nv'>bill_depth_mm</span> <span class='o'>~</span> <span class='nv'>sex</span>, data <span class='o'>=</span> <span class='nv'>penguins_filtered</span><span class='o'>)</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;   Wilcoxon rank sum test with continuity correction</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; data:  bill_depth_mm by sex</span>
<span class='c'>#&gt; W = 72, p-value = 6.79e-05</span>
<span class='c'>#&gt; alternative hypothesis: true location shift is not equal to 0</span></code></pre>
</div>
<h3 id="using-ggplot-to-recreate-the-plot">Using <em>ggplot</em> to recreate the plot</h3>
<p>Above, we created the base plot using <em>ggpubr</em> syntax, but we don&rsquo;t need to do this. The following code would create a very similar plot using <em>ggplot</em> syntax and then only adding the <a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html" target="_blank" rel="noopener"><code>stat_compare_means()</code></a> at the end:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span><span class='nv'>penguins_filtered</span>,
       <span class='nf'>aes</span><span class='o'>(</span><span class='nv'>sex</span>, <span class='nv'>bill_depth_mm</span>, fill <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_boxplot</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>theme_bw</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-13-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h3 id="breakout-rooms-i-10-min">Breakout Rooms I (10 min)</h3>
<div class="puzzle">
<div>
<h3 id="exercise-1">Exercise 1</h3>
<ul>
<li>
<p>Filter the penguins data in order to have only the observations (rows) from the Chinstrap species from Dream island.</p>
</li>
<li>
<p>Create a boxplot using the <em>ggpubr</em> package or using base <em>ggplot</em>.</p>
</li>
<li>
<p>Use <em>stat_compare_means()</em> function to add a p-value.</p>
</li>
</ul>
<details>
<summary>
Hints (click here)
</summary>
<br>
<ul>
<li>Use the <a href="https://rdrr.io/r/stats/filter.html" target="_blank" rel="noopener"><code>filter()</code></a> function to filter rows</li>
<li>Filter using <code>species == Chinstrap</code> and <code>island == Dream</code></li>
<li>If you want to use the <em>ggpubr</em> package to create the boxplot, use the <a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html" target="_blank" rel="noopener"><code>ggboxplot()</code></a> function.</li>
</ul>
</details>
<details>
<summary>
Solution (click here)
</summary>
<br>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Using ggpubr</span>

<span class='c'># Filter by species and island</span>
<span class='nv'>penguins_exc1</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'>%&gt;%</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>species</span> <span class='o'>==</span> <span class='s'>"Chinstrap"</span>, <span class='nv'>island</span> <span class='o'>==</span> <span class='s'>"Dream"</span><span class='o'>)</span>

<span class='c'># Create the plot</span>
<span class='nv'>exc1_plot</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html'>ggboxplot</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins_exc1</span>,
                       x <span class='o'>=</span> <span class='s'>"sex"</span>,
                       y <span class='o'>=</span> <span class='s'>"bill_depth_mm"</span>,
                       fill <span class='o'>=</span> <span class='s'>"sex"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span><span class='o'>)</span>

<span class='c'># Show the plot</span>
<span class='nv'>exc1_plot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-14-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Using ggplot only</span>

<span class='c'># Filter by species and island</span>
<span class='nv'>penguins_exc1</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'>%&gt;%</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>species</span> <span class='o'>==</span> <span class='s'>"Chinstrap"</span>, <span class='nv'>island</span> <span class='o'>==</span> <span class='s'>"Dream"</span><span class='o'>)</span>

<span class='c'># Create the plot</span>
<span class='nv'>exc1_plot_ggplot</span> <span class='o'>&lt;-</span> <span class='nf'>ggplot</span><span class='o'>(</span><span class='nv'>penguins_exc1</span>,
                           <span class='nf'>aes</span><span class='o'>(</span><span class='nv'>sex</span>, <span class='nv'>bill_depth_mm</span>, fill <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_boxplot</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>theme_bw</span><span class='o'>(</span><span class='o'>)</span>

<span class='c'># Show the plot</span>
<span class='nv'>exc1_plot_ggplot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-15-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<br>
<h3 id="multiple-group-comparison-within-a-variable">Multiple group comparison within a variable</h3>
<p>In many experiments we can have multiple groups in a single variable. For example, within a variable <em>nutrient concentration</em> we can have multiple nutrient concentration levels such as 10%, 20%, 30% and so on.</p>
<p>In the case of the penguins data we can find this layout if we need to compare the males bill depth between species. Only for teaching purposes, we are not going to consider any difference by island.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins_male</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'>%&gt;%</span>
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span>

<span class='nv'>penguins_male</span> <span class='o'>%&gt;%</span> 
  <span class='nf'>count</span><span class='o'>(</span><span class='nv'>species</span>, <span class='nv'>sex</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 3 × 3</span></span>
<span class='c'>#&gt;   species   sex       n</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie    male     73</span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Chinstrap male     34</span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Gentoo    male     61</span></code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins_male_plot</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html'>ggboxplot</a></span><span class='o'>(</span><span class='nv'>penguins_male</span>,
                                x <span class='o'>=</span> <span class='s'>"species"</span>,
                                y <span class='o'>=</span> <span class='s'>"bill_depth_mm"</span>,
                                color <span class='o'>=</span> <span class='s'>"species"</span><span class='o'>)</span>
<span class='nv'>penguins_male_plot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-17-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>Like before, we can use the function <code>stat_compare_means</code> to add a p-value for an overall comparison between groups:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins_male_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-18-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>However, we may also be interested in getting a p-value for the different pairwise comparisons between groups. For instance, does the bill depth of Chinstrap penguins differ significantly from that in Gentoo penguins?</p>
<p>To do this, we can pass a <em>list</em> to that the <code>stat_compare_means</code> function. A list is a flexible, hierarchical R data structure. Here, we will use a list to store multiple vectors, each of which contains a pairwise comparison of interest:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>comparison_list</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Adelie"</span>, <span class='s'>"Chinstrap"</span><span class='o'>)</span>,
                        <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Chinstrap"</span>, <span class='s'>"Gentoo"</span><span class='o'>)</span>,
                        <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Adelie"</span>, <span class='s'>"Gentoo"</span><span class='o'>)</span><span class='o'>)</span>

<span class='nv'>penguins_male_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span>comparisons <span class='o'>=</span> <span class='nv'>comparison_list</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span>label.y <span class='o'>=</span> <span class='m'>25</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-19-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h3 id="breakout-rooms-ii-10-min">Breakout Rooms II (10 min)</h3>
<div class="puzzle">
<div>
<h3 id="exercise-2">Exercise 2</h3>
<ul>
<li>
<p>Filter the penguins data in order to have only the observations (rows) from female penguins.</p>
</li>
<li>
<p>Create a boxplot using the <em>ggpubr</em> package.</p>
</li>
<li>
<p>Add the multiple group comparison</p>
</li>
<li>
<p>Add pairwise comparisons between all groups combinations</p>
</li>
</ul>
<details>
<summary>
Hints (click here)
</summary>
<br>
<ul>
<li>
<p>Use the <a href="https://rdrr.io/r/stats/filter.html" target="_blank" rel="noopener"><code>filter()</code></a> function to select desired rows</p>
</li>
<li>
<p>Filter by <code>sex == &quot;female&quot;</code></p>
</li>
<li>
<p>Use <a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html" target="_blank" rel="noopener"><code>ggboxplot()</code></a> function for the base plot</p>
</li>
<li>
<p>Use the <a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html" target="_blank" rel="noopener"><code>stat_compare_means()</code></a> function for multiple group comparison</p>
</li>
<li>
<p>Use the <code>comparison</code> argument to add pairwise comparison</p>
</li>
</ul>
</details>
<details>
<summary>
Solution (click here)
</summary>
<br>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Filtering by sex</span>
<span class='nv'>penguins_exc2</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'>%&gt;%</span> 
  <span class='c'># Filter by species and island</span>
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"female"</span><span class='o'>)</span>

<span class='c'># Creating the base plot</span>
<span class='nv'>exc2_plot</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html'>ggboxplot</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins_exc2</span>,
                       x <span class='o'>=</span> <span class='s'>"species"</span>,
                       y <span class='o'>=</span> <span class='s'>"bill_depth_mm"</span>,
                       fill <span class='o'>=</span> <span class='s'>"species"</span><span class='o'>)</span>

<span class='c'># Adding the multiple group comparison</span>
<span class='nv'>exc2_plot</span> <span class='o'>&lt;-</span> <span class='nv'>exc2_plot</span> 

<span class='c'># Creating the pairwise comparison</span>
<span class='nv'>exc2_comparison</span> <span class='o'>&lt;-</span>  <span class='nf'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Adelie"</span>, <span class='s'>"Chinstrap"</span><span class='o'>)</span>,
                         <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Chinstrap"</span>, <span class='s'>"Gentoo"</span><span class='o'>)</span>,
                         <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"Adelie"</span>, <span class='s'>"Gentoo"</span><span class='o'>)</span><span class='o'>)</span>

<span class='nv'>exc2_plot</span> <span class='o'>&lt;-</span> <span class='nv'>exc2_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span>comparisons <span class='o'>=</span> <span class='nv'>comparison_list</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html'>stat_compare_means</a></span><span class='o'>(</span>label.y <span class='o'>=</span> <span class='m'>25</span><span class='o'>)</span>

<span class='nv'>exc2_plot</span>
</code></pre>
<p><img src="figs/unnamed-chunk-20-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<br>

                    </div>

                    <br>

                    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://biodash.github.io/codeclub/s02e10_ggpubr/&amp;text=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://biodash.github.io/codeclub/s02e10_ggpubr/&amp;t=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr&amp;body=https://biodash.github.io/codeclub/s02e10_ggpubr/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://biodash.github.io/codeclub/s02e10_ggpubr/&amp;title=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr%20https://biodash.github.io/codeclub/s02e10_ggpubr/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://biodash.github.io/codeclub/s02e10_ggpubr/&amp;title=Code%20Club%20S02E10:%20An%20introduction%20to%20ggpubr" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    




  
















                    <br>

                    <hr class="separator">

                    <div class="clearfix">
                        
                        
                        <span class="previous-link">
                            <a href="https://biodash.github.io/codeclub/s02e09_multiple_plots_part2/">← Code Club S02E09: Combining Plots - Part 2</a>
                        </span>
                        
                        
                        
                    </div>

                    <hr class="separator">

                </div>

            </article>

            
        </main>
    </div>
</div>

  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
    
    <p class="powered-by">
      <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
    </p>
    
</footer>
    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
    
      <script async defer src="https://maps.googleapis.com/maps/api/js?key="></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
      
    
    <script src="/en/js/wowchemy.min.2f16af175a3ec51b41b36bb4934b1cf7.js"></script>

    






</body>
</html>
