<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.0.0-beta.3 for Hugo" />
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jelmer Poelstra" />

  
  
  
    
  
  <meta name="description" content="Today, we will be making cool maps in R!" />

  
  <link rel="alternate" hreflang="en-us" href="https://biodash.github.io/codeclub/11_ggplot-maps/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#3f51b5" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.80f9a276c6100914c616a06e45ba8d09.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F9CQ7P0DX"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-9F9CQ7P0DX', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="https://biodash.github.io/codeclub/11_ggplot-maps/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="BioDASH" />
  <meta property="og:url" content="https://biodash.github.io/codeclub/11_ggplot-maps/" />
  <meta property="og:title" content="Session 11: Spatial data visualization with ggplot2 | BioDASH" />
  <meta property="og:description" content="Today, we will be making cool maps in R!" /><meta property="og:image" content="https://biodash.github.io/media/logo_hu6407506e646a281542ecb299640680ce_37988_300x300_fit_lanczos_2.png" />
    <meta property="twitter:image" content="https://biodash.github.io/media/logo_hu6407506e646a281542ecb299640680ce_37988_300x300_fit_lanczos_2.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-02-24T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-02-25T17:59:05-05:00">
  

  



  

  

  <link rel='stylesheet' href='/css/highlight-light.css' title='hl-light'>
<link rel='stylesheet' href='/css/highlight-dark.css' title='hl-dark' disabled>



  <title>Session 11: Spatial data visualization with ggplot2 | BioDASH</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="29ed38d8f1680daed1e667b71019651a" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7a224883d792570fd34d30c7134eace3.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Code Club</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/codeclub-schedule/"><span>- <b>Schedule</b></span></a>
            
              <a class="dropdown-item" href="/codeclub-schedule/#previous-semesters"><span>- Past Sessions</span></a>
            
              <a class="dropdown-item" href="/codeclub-setup/"><span>- Computer Setup</span></a>
            
              <a class="dropdown-item" href="/"><span>------------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-suggest/"><span>- Suggest a Topic</span></a>
            
              <a class="dropdown-item" href="/codeclub-present/"><span>- Info for Presenters</span></a>
            
              <a class="dropdown-item" href="/"><span>-----------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-about/"><span>- <b>About Code Club & Join Us!</b></span></a>
            
          </div>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Tutorials & Resources</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/events/"><span>Events</span></a>
            
              <a class="dropdown-item" href="/"><span>---------------------</span></a>
            
              <a class="dropdown-item" href="/tutorials/r-resources-tips/"><span>- R Resources and Tips</span></a>
            
              <a class="dropdown-item" href="/"><span>--------------------</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/2020-12-microbiomics-workshop/"><span>- Metabarcoding workshop (Fall '20)</span></a>
            
              <a class="dropdown-item" href="/tutorials/2021-01_rnaseq/"><span>- RNA-seq intro meetings (Spring '21)</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/pracs-sp21/"><span>- Computing Course (Spring '21)</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/support/"><span>Bioinformatics Support</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://github.com/biodash/biodash.github.io" target="_blank" rel="noopener"><i class='fab fa-github'></i><span></span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/index.xml" target="_blank" rel="noopener"><i class='fas fa-rss'></i><span></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      
        
      
        
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    
<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
        <div class="d-none d-xl-block col-xl-2 docs-toc">
            <ul class="nav toc-top">
                <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
            </ul>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#prep-and-setup">Prep and setup</a>
      <ul>
        <li><a href="#new-to-code-club">New to Code Club?</a></li>
        <li><a href="#new-to-ggplot2">New to <em>ggplot2</em>?</a></li>
        <li><a href="#download-the-csv-file-on-ohio">Download the CSV file on Ohio</a></li>
      </ul>
    </li>
    <li><a href="#creating-maps-in-r">Creating maps in R</a></li>
    <li><a href="#our-first-maps">Our first maps</a></li>
    <li><a href="#the-structure-of-the-dataframe-ohio">The structure of the dataframe <code>ohio</code>.</a></li>
    <li><a href="#add-information-to-the-maps">Add information to the maps</a></li>
    <li><a href="#breakout-rooms">Breakout rooms</a>
      <ul>
        <li><a href="#exercise-1">Exercise 1</a></li>
        <li><a href="#exercise-2">Exercise 2</a></li>
        <li><a href="#bonus-exercise">Bonus exercise</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        <main class="col-12 col-md-0 col-xl-10 py-md-3 pl-md-5 docs-content" role="main">
            

            <article class="article">

                












  

  
  
  
<div class="article-container pt-3">
  <h1>Session 11: Spatial data visualization with ggplot2</h1>

  

  
    



<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      <a href="/authors/stephen-opiyo/">Stephen Opiyo</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
    Feb 25, 2021
  </span>
  

  

  

  
  
  
  
  

  
  

</div>

    





  
</div>



                <div class="article-container">
                    <div class="article-style">
                        <p><br> <br></p>
<hr>
<h2 id="prep-and-setup">Prep and setup</h2>
<h3 id="new-to-code-club">New to Code Club?</h3>
<ul>
<li>
<p>If you didn&rsquo;t already do this, please follow the <a href="/codeclub-setup/04_ggplot2/">Code Club Computer Setup</a> instructions, which also has pointers for if you&rsquo;re new to R or RStudio.</p>
</li>
<li>
<p>If you&rsquo;re able to do so, please open RStudio a bit before Code Club starts &ndash; and in case you run into issues, please join the Zoom call early and we&rsquo;ll help you troubleshoot.</p>
</li>
</ul>
<h3 id="new-to-ggplot2">New to <em>ggplot2</em>?</h3>
<p>Check out the two Code Club pages for <a href="/codeclub/04_ggplot2/">Session 4</a> and <a href="/codeclub/05_ggplot-round-2/">Session 5</a>.</p>
<p>If you&rsquo;ve never used <code>ggplot2</code> before (or even if you have), you may find <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" target="_blank" rel="noopener">this cheat sheet</a> useful.</p>
<h3 id="download-the-csv-file-on-ohio">Download the CSV file on Ohio</h3>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>ohio_csv</span> <span class='o'>&lt;-</span> 
  <span class='s'>'https://raw.githubusercontent.com/biodash/biodash.github.io/master/content/codeclub/11_ggplot-maps/Ohio.csv'</span>

<span class='nf'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='o'>(</span>url <span class='o'>=</span> <span class='nv'>ohio_csv</span>, destfile <span class='o'>=</span> <span class='s'>'Ohio.csv'</span><span class='o'>)</span>
</code></pre>
</div>
<br>
<hr>
<h2 id="creating-maps-in-r">Creating maps in R</h2>
<p>Today, we will cover the visualization of spatial data in R using the layered grammar of graphics implementation of ggplot2 in conjunction with the contextual information of static maps from world maps in the <em>maps</em> package.</p>
<p><strong>Before we look at mapping using ggplot2, let us define some terms.</strong></p>
<p><em>Areal data</em> <br/> Areal data is data which corresponds to geographical extents with polygonal boundaries.</p>
<p><em>The layered grammar of graphics</em> <br/> By definition, the layered grammar demands that every plot consist of five components: <br/></p>
<ul>
<li>
<p>a default dataset with aesthetic mappings,<br/></p>
</li>
<li>
<p>one or more layers, each with either a geometric object (&ldquo;geom&rdquo;), a statistical transformation (&ldquo;stat&rdquo;), etc.<br/></p>
</li>
<li>
<p>a scale for each aesthetic mapping (which can be automatically generated),<br/></p>
</li>
<li>
<p>a coordinate system, and <br/></p>
</li>
<li>
<p>a facet specification. <br/></p>
</li>
</ul>
<p>Since <em>ggplot2</em> is an implementation of the layered grammar of graphics, every plot made with ggplot2 has each of the above elements. Consequently, map plots also have these elements, but certain elements are ﬁxed to map components: the <code>x</code> aesthetic is ﬁxed to longitude, the <code>y</code> aesthetic is ﬁxed to latitude.</p>
<p><strong>Drawing a map</strong> <br/> Drawing a map in R requires two things. <strong>First</strong>, we have to draw the map using data that directs R to draw the polygon shapes that constitute the map. Then we <strong>add</strong> information to our map to plot color and marks. It&rsquo;s the same basic logic that we have used in ggplot figures. The key thing is to have datasets that link that geographic data with the information that we want to put on the plot.</p>
<p><em>The maps package in R</em> <br/> The &ldquo;maps&rdquo; package in R contains a set of maps of the United States and the world drawn using longitude and latitude data. With world map, the USA map with the individual states you can accomplish a lot of the mapping tasks using the maps package. The maps package contains a lot of outlines of continents, countries, states, and counties</p>
<p><strong>Making dataframes from map outlines by ggplot2</strong> <br/> Recall that ggplot2 operates on dataframes. Therefore, we need some way to translate the maps data into a data frame format the ggplot can use. The package <em>ggplot2</em> provides the <code>map_data()</code> function. The function turns a series of points along an outline into a data frame of those points. The package ggplot2 uses the following syntax: <code>map_data(&quot;name&quot;)</code> where &ldquo;name&rdquo; is a quoted string of the name of a map in the <em>maps</em> package.<br/></p>
<h2 id="our-first-maps">Our first maps</h2>
<p>Let us start by drawing maps of the World, USA, states, Ohio, Ohio and Indiana, and part of Europe using the <em>maps</em> package.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='o'>)</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'>maps</span><span class='o'>)</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://scales.r-lib.org'>scales</a></span><span class='o'>)</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='o'>)</span>

<span class='c'># Let us get a world map using the "map_data" function </span>
<span class='nv'>world</span> <span class='o'>&lt;-</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"world"</span><span class='o'>)</span>

<span class='c'>## Let us get a US map:</span>
<span class='nv'>usa</span> <span class='o'>&lt;-</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"usa"</span><span class='o'>)</span>

<span class='c'># Let us get the states:</span>
<span class='nv'>states</span> <span class='o'>&lt;-</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"state"</span><span class='o'>)</span>

<span class='c'># Select Ohio using the filter function:</span>
<span class='nv'>ohio</span> <span class='o'>&lt;-</span> <span class='nv'>states</span> <span class='o'>%&gt;%</span>
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"ohio"</span><span class='o'>)</span>
</code></pre>
</div>
<ul>
<li>Let us plot a world map:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>world</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"white"</span>, color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-3-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Let us plot a map of the US:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y<span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"white"</span>, color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-4-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Let us plot a map of the US with states:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>states</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"blue"</span>, color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-5-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Let us plot a map of Ohio:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio</span>,
       mapping<span class='o'>=</span><span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"white"</span>, color <span class='o'>=</span> <span class='s'>"green"</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-6-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>We can also plot a map for an arbitrary selection of states:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># We can select data for two states, for example Ohio and Indiana:</span>
<span class='nv'>ohio_indiana</span> <span class='o'>&lt;-</span> <span class='nv'>states</span> <span class='o'>%&gt;%</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"ohio"</span> <span class='o'>|</span> <span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"indiana"</span><span class='o'>)</span>

<span class='c'># Plot the map of Ohio and Indiana:</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_indiana</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"green"</span> , color <span class='o'>=</span> <span class='s'>"red"</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-7-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>We can also plot only a specific region by filtering by latitude and longitude:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>world</span> <span class='o'>&lt;-</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"world"</span><span class='o'>)</span>
<span class='nv'>a_region</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>world</span>, <span class='nv'>long</span> <span class='o'>&gt;</span><span class='o'>-</span> <span class='m'>10</span> <span class='o'>&amp;</span> <span class='nv'>long</span> <span class='o'>&lt;</span> <span class='m'>15.1</span> <span class='o'>&amp;</span> <span class='nv'>lat</span> <span class='o'>&gt;</span> <span class='m'>32</span> <span class='o'>&amp;</span> <span class='nv'>lat</span> <span class='o'>&lt;</span> <span class='m'>55</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>a_region</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"white"</span>, color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-8-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h2 id="the-structure-of-the-dataframe-ohio">The structure of the dataframe <code>ohio</code>.</h2>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>ohio</span><span class='o'>)</span>

<span class='c'>#&gt;        long      lat group order region subregion</span>
<span class='c'>#&gt; 1 -80.51776 40.64563    42 10440   ohio      &lt;NA&gt;</span>
<span class='c'>#&gt; 2 -80.55787 40.63990    42 10441   ohio      &lt;NA&gt;</span>
<span class='c'>#&gt; 3 -80.62089 40.63417    42 10442   ohio      &lt;NA&gt;</span>
<span class='c'>#&gt; 4 -80.66100 40.61698    42 10443   ohio      &lt;NA&gt;</span>
<span class='c'>#&gt; 5 -80.66673 40.60552    42 10444   ohio      &lt;NA&gt;</span>
<span class='c'>#&gt; 6 -80.67245 40.58833    42 10445   ohio      &lt;NA&gt;</span>
</code></pre>
</div>
<p>Look at the variables in <em>ohio</em>, note what they refer to: <br/></p>
<ul>
<li>
<p><code>long</code> = longitude. Lines of longitude, or meridians, run between the North and South Poles and measure east-west positions. While prime meridian is assigned the value of 0 degrees, and runs through Greenwich (England), meridians to the west of the prime meridian are measured in degrees west (up to 180 degrees) and those to the east of the prime meridian are measured to in degrees east (up to 180 degrees).<br/></p>
</li>
<li>
<p><code>lat</code> = latitude. Lines of latitude measure north-south position between the poles with the equator defined as 0 degrees, the North Pole defined as 90 degrees north, and the South Pole defined as 90 degrees south. <br/></p>
</li>
<li>
<p><code>group</code> = an identifier that is unique for each subregion (here the counties). Group is very important! ggplot2&rsquo;s functions can take a group argument which controls (amongst other things) whether adjacent points should be connected by lines. If they are in the same group, then they get connected, but if they are in different groups then they don&rsquo;t. <br/></p>
</li>
<li>
<p><code>order</code> = an identifier that indicates the order in which the boundary lines should be drawn <br/></p>
</li>
<li>
<p><code>region</code> = string indicator for regions (here the states) <br/></p>
</li>
<li>
<p><code>subregion</code> = string indicator for sub-regions (here the county names) <br/></p>
</li>
</ul>
<h2 id="add-information-to-the-maps">Add information to the maps</h2>
<p><strong>The second part of mapping in R, is to add information on the map created in the first part.</strong> <br/> In drawing the map, the &ldquo;<em>maps</em>&rdquo; package creates the backbone for visualizations. Then we add additional information to show colors and shapes. <br/></p>
<p><em>We will:</em> <br/> - fill a map by region, <br/> - draw a Bubble map using city population, <br/> - make a point for every city, <br/> - vary size of point by city size and vary the color of the dots, and <br/> - add external data to the map. <br/></p>
<ul>
<li>Let us fill by region and make sure the the lines of state borders are white:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>states</span><span class='o'>)</span> <span class='o'>+</span> 
 <span class='nf'>geom_polygon</span><span class='o'>(</span><span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, fill <span class='o'>=</span> <span class='nv'>region</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span>,
              color <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span> 
 <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>guides</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span> <span class='c'># Do this to omit the legend</span>

</code></pre>
<p><img src="figs/unnamed-chunk-10-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Let us draw a &ldquo;Bubble map&rdquo;:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># The maps package has city data</span>
<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nf'>maps</span><span class='nf'>::</span><span class='nv'><a href='https://rdrr.io/pkg/maps/man/world.cities.html'>world.cities</a></span><span class='o'>)</span>

<span class='c'>#&gt;                 name country.etc   pop   lat  long capital</span>
<span class='c'>#&gt; 1 'Abasan al-Jadidah   Palestine  5629 31.31 34.34       0</span>
<span class='c'>#&gt; 2 'Abasan al-Kabirah   Palestine 18999 31.32 34.35       0</span>
<span class='c'>#&gt; 3       'Abdul Hakim    Pakistan 47788 30.55 72.11       0</span>
<span class='c'>#&gt; 4 'Abdullah-as-Salam      Kuwait 21817 29.36 47.98       0</span>
<span class='c'>#&gt; 5              'Abud   Palestine  2456 32.03 35.07       0</span>
<span class='c'>#&gt; 6            'Abwein   Palestine  3434 32.03 35.20       0</span>


<span class='nv'>my_cities</span> <span class='o'>&lt;-</span> <span class='nf'>maps</span><span class='nf'>::</span><span class='nv'><a href='https://rdrr.io/pkg/maps/man/world.cities.html'>world.cities</a></span>

<span class='nv'>usa_cities</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>my_cities</span>,<span class='nv'>country.etc</span> <span class='o'>==</span> <span class='s'>"USA"</span><span class='o'>)</span>

<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>usa_cities</span><span class='o'>)</span>

<span class='c'>#&gt;      name country.etc    pop   lat    long capital</span>
<span class='c'>#&gt; 1 Abilene         USA 113888 32.45  -99.74       0</span>
<span class='c'>#&gt; 2   Akron         USA 206634 41.08  -81.52       0</span>
<span class='c'>#&gt; 3 Alameda         USA  70069 37.77 -122.26       0</span>
<span class='c'>#&gt; 4  Albany         USA  45535 44.62 -123.09       0</span>
<span class='c'>#&gt; 5  Albany         USA  75510 31.58  -84.18       0</span>
<span class='c'>#&gt; 6  Albany         USA  93576 42.67  -73.80       0</span>
</code></pre>
</div>
<ul>
<li>Make a point for every city:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
 <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
            <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-12-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Let&rsquo;s pick just the big cities:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>usa_big_cities</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>my_cities</span>, <span class='nv'>country.etc</span> <span class='o'>==</span> <span class='s'>"USA"</span> <span class='o'>&amp;</span> <span class='nv'>pop</span> <span class='o'>&gt;</span> <span class='m'>500000</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa_big_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-13-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Vary size of point by city size:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa_big_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, size <span class='o'>=</span> <span class='nv'>pop</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-14-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Now vary the color of the dots:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>usa_big_cities</span><span class='o'>$</span><span class='nv'>qual</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='o'>(</span><span class='nv'>LETTERS</span><span class='o'>[</span><span class='m'>1</span><span class='o'>:</span><span class='m'>5</span><span class='o'>]</span>, <span class='nf'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='o'>(</span><span class='nv'>usa_big_cities</span><span class='o'>)</span>,
                              replace <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa_big_cities</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, color <span class='o'>=</span> <span class='nv'>qual</span>, size <span class='o'>=</span> <span class='nv'>pop</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-15-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Tweak the map:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># No scientific notation in legend r ggplot:</span>
<span class='c'># scales package adds the "scale_size_continuous" function, and we can set label=comma</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://scales.r-lib.org'>scales</a></span><span class='o'>)</span>

<span class='c'># Change the column name to make the legend nicer"</span>
<span class='nv'>usa_big_cities</span><span class='o'>$</span><span class='nv'>Population</span> <span class='o'>&lt;-</span> <span class='nv'>usa_big_cities</span><span class='o'>$</span><span class='nv'>pop</span>
<span class='nv'>usa_big_cities</span><span class='o'>$</span><span class='nv'>Qualitative</span> <span class='o'>&lt;-</span> <span class='nv'>usa_big_cities</span><span class='o'>$</span><span class='nv'>qual</span>

<span class='c'># Do some additional refining:</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y<span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>usa_big_cities</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>,
                 color <span class='o'>=</span> <span class='nv'>Qualitative</span>, size <span class='o'>=</span> <span class='nv'>Population</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>scale_size_continuous</span><span class='o'>(</span>label <span class='o'>=</span> <span class='nv'>comma</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-16-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Work with Ohio counties with external data:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Get basic map data for all USA counties:</span>
<span class='nv'>usa_counties</span> <span class='o'>=</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"county"</span><span class='o'>)</span> 

<span class='c'># Subset to counties in Ohio:</span>
<span class='nv'>oh</span> <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='o'>(</span><span class='nv'>usa_counties</span>, <span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"ohio"</span><span class='o'>)</span> 
<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>oh</span><span class='o'>)</span>

<span class='c'>#&gt;            long      lat group order region subregion</span>
<span class='c'>#&gt; 59960 -83.66902 39.02989  2012 59960   ohio     adams</span>
<span class='c'>#&gt; 59961 -83.56590 39.02989  2012 59961   ohio     adams</span>
<span class='c'>#&gt; 59962 -83.37109 39.06426  2012 59962   ohio     adams</span>
<span class='c'>#&gt; 59963 -83.30806 39.06426  2012 59963   ohio     adams</span>
<span class='c'>#&gt; 59964 -83.30233 39.05280  2012 59964   ohio     adams</span>
<span class='c'>#&gt; 59965 -83.25649 39.01842  2012 59965   ohio     adams</span>
</code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Plot ohio counties</span>
<span class='nf'>ggplot</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>oh</span>,
               <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span>, fill <span class='o'>=</span> <span class='nv'>subregion</span><span class='o'>)</span>,
               color <span class='o'>=</span> <span class='s'>"black"</span>, alpha <span class='o'>=</span> <span class='m'>0.3</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>guides</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>ggtitle</span><span class='o'>(</span><span class='s'>"Ohio counties"</span><span class='o'>)</span>  

</code></pre>
<p><img src="figs/unnamed-chunk-18-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Read population data for Ohio counties:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># The data of the estimated population of each  county in 2021 and percent change from 2010</span>
<span class='nv'>Ohio</span> <span class='o'>&lt;-</span> <span class='nf'>read_csv</span><span class='o'>(</span><span class='s'>"Ohio.csv"</span><span class='o'>)</span>
<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>Ohio</span><span class='o'>)</span>

<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 6 x 6</span></span>
<span class='c'>#&gt;   county       Pop  Perc Town         x_1   y_1</span>
<span class='c'>#&gt;   <span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span><span> Adams      </span><span style='text-decoration: underline;'>27</span><span>706 -</span><span style='color: #BB0000;'>2.91</span><span> West Union -</span><span style='color: #BB0000;'>83.5</span><span>  38.8</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span><span> Allen     </span><span style='text-decoration: underline;'>101</span><span>603 -</span><span style='color: #BB0000;'>4.47</span><span> Lima       -</span><span style='color: #BB0000;'>84.1</span><span>  40.7</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span><span> Ashland    </span><span style='text-decoration: underline;'>53</span><span>040 -</span><span style='color: #BB0000;'>0.53</span><span> Ashland    -</span><span style='color: #BB0000;'>82.3</span><span>  40.9</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span><span> Ashtabula  </span><span style='text-decoration: underline;'>96</span><span>549 -</span><span style='color: #BB0000;'>4.79</span><span> Jefferson  -</span><span style='color: #BB0000;'>80.8</span><span>  41.7</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>5</span><span> Athens     </span><span style='text-decoration: underline;'>64</span><span>943 -</span><span style='color: #BB0000;'>0.35</span><span> Athens     -</span><span style='color: #BB0000;'>82.1</span><span>  39.3</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>6</span><span> Auglaize   </span><span style='text-decoration: underline;'>45</span><span>496 -</span><span style='color: #BB0000;'>0.88</span><span> Wapakoneta -</span><span style='color: #BB0000;'>84.2</span><span>  40.6</span></span>
</code></pre>
</div>
<ul>
<li>Prepare the data for plotting:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Create a new  column called  "county" so that counties start with capital letters</span>
<span class='c'># using str_to_title function </span>
<span class='nv'>oh</span><span class='o'>$</span><span class='nv'>county</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_title</a></span><span class='o'>(</span><span class='nv'>oh</span><span class='o'>$</span><span class='nv'>subregion</span><span class='o'>)</span>

<span class='c'># Merge population data with counties data by county variable using inner_join</span>
<span class='c'># function, and named the new object "ohio_pop"</span>
<span class='nv'>ohio_pop</span> <span class='o'>&lt;-</span> <span class='nf'>inner_join</span><span class='o'>(</span><span class='nv'>oh</span>, <span class='nv'>Ohio</span>, by <span class='o'>=</span> <span class='s'>"county"</span><span class='o'>)</span>

<span class='c'># Select counties with population greater than 100000</span>
<span class='nv'>ohio_big_pop</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span>, <span class='nv'>Pop</span> <span class='o'>&gt;</span> <span class='m'>100000</span><span class='o'>)</span>
</code></pre>
</div>
<ul>
<li>Create the plot where we vary point size by population size:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'>###  vary size of point by population size</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_pop</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span><span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span><span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_big_pop</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>x_1</span>, y <span class='o'>=</span> <span class='nv'>y_1</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, size <span class='o'>=</span> <span class='nv'>Pop</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>guides</span><span class='o'>(</span>size <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span> <span class='c'># Omit the legend</span>

</code></pre>
<p><img src="figs/unnamed-chunk-21-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>Improve the graph by creating groups of population using quantile.</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>ApplyQuintiles</span> <span class='o'>&lt;-</span> <span class='kr'>function</span><span class='o'>(</span><span class='nv'>x</span><span class='o'>)</span> <span class='o'>&#123;</span>
  <span class='nf'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='o'>(</span><span class='nv'>x</span>, breaks <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span><span class='o'>$</span><span class='nv'>Pop</span>, probs <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='o'>(</span><span class='m'>0</span>, <span class='m'>1</span>, by <span class='o'>=</span> <span class='m'>0.2</span><span class='o'>)</span><span class='o'>)</span><span class='o'>)</span>,
      labels <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"0-20"</span>, <span class='s'>"20-40"</span>, <span class='s'>"40-60"</span>, <span class='s'>"60-80"</span>, <span class='s'>"80-100"</span><span class='o'>)</span>,
      include.lowest <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span>
<span class='o'>&#125;</span>

<span class='nv'>ohio_pop</span><span class='o'>$</span><span class='nv'>grouped_pop</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span><span class='o'>$</span><span class='nv'>Pop</span>, <span class='nv'>ApplyQuintiles</span><span class='o'>)</span>
<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span><span class='o'>)</span>

<span class='c'>#&gt;        long      lat group order region subregion county   Pop  Perc       Town</span>
<span class='c'>#&gt; 1 -83.66902 39.02989  2012 59960   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt; 2 -83.56590 39.02989  2012 59961   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt; 3 -83.37109 39.06426  2012 59962   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt; 4 -83.30806 39.06426  2012 59963   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt; 5 -83.30233 39.05280  2012 59964   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt; 6 -83.25649 39.01842  2012 59965   ohio     adams  Adams 27706 -2.91 West Union</span>
<span class='c'>#&gt;         x_1      y_1 grouped_pop</span>
<span class='c'>#&gt; 1 -83.54616 38.79483        0-20</span>
<span class='c'>#&gt; 2 -83.54616 38.79483        0-20</span>
<span class='c'>#&gt; 3 -83.54616 38.79483        0-20</span>
<span class='c'>#&gt; 4 -83.54616 38.79483        0-20</span>
<span class='c'>#&gt; 5 -83.54616 38.79483        0-20</span>
<span class='c'>#&gt; 6 -83.54616 38.79483        0-20</span>
</code></pre>
</div>
<ul>
<li>Plot the map:</li>
</ul>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>ggplot</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_pop</span>,
               <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span>, fill <span class='o'>=</span> <span class='nv'>grouped_pop</span><span class='o'>)</span>,
               color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>scale_fill_brewer</span><span class='o'>(</span>palette <span class='o'>=</span> <span class='s'>"Reds"</span>, direction <span class='o'>=</span> <span class='m'>1</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>labs</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"Population Quantiles"</span><span class='o'>)</span> 

</code></pre>
<p><img src="figs/unnamed-chunk-23-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h2 id="breakout-rooms">Breakout rooms</h2>
<div class="puzzle">
<h3 id="exercise-1">Exercise 1</h3>
<p>Use the dataset of 2021 Ohio county&rsquo;s population to plot counties with % positive population growth.</p>
<details>
<summary> Solution (click here) </summary>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Get basic map data for all USA counties:</span>
<span class='nv'>usa_counties</span> <span class='o'>=</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"county"</span><span class='o'>)</span>    

<span class='c'># Subset to counties in Ohio:</span>
<span class='nv'>oh</span> <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='o'>(</span><span class='nv'>usa_counties</span>, <span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"ohio"</span><span class='o'>)</span>  

<span class='c'># Read population data:</span>
<span class='nv'>Ohio</span> <span class='o'>&lt;-</span> <span class='nf'>read_csv</span><span class='o'>(</span><span class='s'>"Ohio.csv"</span><span class='o'>)</span> 

<span class='c'># Create a new  column called  "county" so that counties start with capital</span>
<span class='c'># letters using str_to_title function </span>
<span class='nv'>oh</span><span class='o'>$</span><span class='nv'>county</span> <span class='o'>=</span> <span class='nf'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_title</a></span><span class='o'>(</span><span class='nv'>oh</span><span class='o'>$</span><span class='nv'>subregion</span><span class='o'>)</span>

<span class='c'># Merge counties with population:</span>
<span class='nv'>ohio_pop</span><span class='o'>&lt;-</span><span class='nf'>inner_join</span><span class='o'>(</span><span class='nv'>oh</span>, <span class='nv'>Ohio</span>, by <span class='o'>=</span> <span class='s'>"county"</span><span class='o'>)</span>

<span class='c'># Select counties with % positive population growth:</span>
<span class='nv'>ohio_pos_pop</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span>, <span class='nv'>Perc</span> <span class='o'>&gt;</span> <span class='m'>0</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_pop</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_pos_pop</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>x_1</span>, y <span class='o'>=</span> <span class='nv'>y_1</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, size <span class='o'>=</span> <span class='nv'>Perc</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>guides</span><span class='o'>(</span>size <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span>  <span class='c'>#  Omit the legend</span>

</code></pre>
<p><img src="figs/unnamed-chunk-24-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</details>
</div>
<div class="puzzle">
<h3 id="exercise-2">Exercise 2</h3>
<p>Use the same data to plot counties with % negative population growth with quantile of 0-20, 20-40, 40-60, 60-80, and 80-100.</p>
<details>
<summary> Solution (click here) </summary>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>ohio_neg_pop</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>ohio_pop</span>, <span class='nv'>Perc</span><span class='o'>&lt;</span><span class='m'>0</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_pop</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x<span class='o'>=</span> <span class='nv'>long</span>, y<span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span><span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color<span class='o'>=</span><span class='s'>"black"</span>,fill<span class='o'>=</span><span class='s'>"white"</span><span class='o'>)</span><span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_neg_pop</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>x_1</span>,y <span class='o'>=</span> <span class='nv'>y_1</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, size <span class='o'>=</span> <span class='nv'>Perc</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>guides</span><span class='o'>(</span>size <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span> <span class='c'># Omit the legend</span>

</code></pre>
<p><img src="figs/unnamed-chunk-25-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>ApplyQuintiles_n</span> <span class='o'>&lt;-</span> <span class='kr'>function</span><span class='o'>(</span><span class='nv'>x</span><span class='o'>)</span> <span class='o'>&#123;</span>
  <span class='nf'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='o'>(</span><span class='nv'>x</span>, breaks <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='nf'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='o'>(</span><span class='nv'>ohio_neg_pop</span><span class='o'>$</span><span class='nv'>Perc</span>, probs <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='o'>(</span><span class='m'>0</span>, <span class='m'>1</span>, by <span class='o'>=</span> <span class='m'>0.2</span><span class='o'>)</span><span class='o'>)</span><span class='o'>)</span>,
      labels <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"0-20"</span>, <span class='s'>"20-40"</span>, <span class='s'>"40-60"</span>, <span class='s'>"60-80"</span>, <span class='s'>"80-100"</span><span class='o'>)</span>,
      include.lowest <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span>
<span class='o'>&#125;</span>

<span class='nv'>ohio_neg_pop</span><span class='o'>$</span><span class='nv'>grouped_pop</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='o'>(</span><span class='nv'>ohio_neg_pop</span><span class='o'>$</span><span class='nv'>Perc</span>, <span class='nv'>ApplyQuintiles_n</span><span class='o'>)</span>

<span class='c'># Plot the map</span>
<span class='nf'>ggplot</span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>ohio_neg_pop</span>,
               <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span>, fill <span class='o'>=</span> <span class='nv'>grouped_pop</span><span class='o'>)</span>,
               color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'>coord_fixed</span><span class='o'>(</span><span class='m'>1.3</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>scale_fill_brewer</span><span class='o'>(</span>palette <span class='o'>=</span> <span class='s'>"Set1"</span>, direction <span class='o'>=</span> <span class='o'>-</span><span class='m'>1</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>labs</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"Negative population growth counties"</span><span class='o'>)</span> 

</code></pre>
<p><img src="figs/unnamed-chunk-26-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</details>
</div>
<div class="puzzle">
<h3 id="bonus-exercise">Bonus exercise</h3>
<p>Plot the cities of France with population greater than 100,000. Vary size of point by city size, and vary the color of the dots.</p>
<details>
<summary> Solution (click here) </summary>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>world</span> <span class='o'>&lt;-</span> <span class='nf'>map_data</span><span class='o'>(</span><span class='s'>"world"</span><span class='o'>)</span>

<span class='nv'>france</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>world</span>,<span class='nv'>region</span> <span class='o'>==</span> <span class='s'>"France"</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>labs</span><span class='o'>(</span>fill <span class='o'>=</span> <span class='s'>"France"</span><span class='o'>)</span> 

</code></pre>
<p><img src="figs/unnamed-chunk-27-1.png" width="700px" style="display: block; margin: auto;" /></p>
<pre class='chroma'><code class='language-r' data-lang='r'>
<span class='c'># The "maps" package has city data</span>
<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nf'>maps</span><span class='nf'>::</span><span class='nv'><a href='https://rdrr.io/pkg/maps/man/world.cities.html'>world.cities</a></span><span class='o'>)</span>

<span class='c'>#&gt;                 name country.etc   pop   lat  long capital</span>
<span class='c'>#&gt; 1 'Abasan al-Jadidah   Palestine  5629 31.31 34.34       0</span>
<span class='c'>#&gt; 2 'Abasan al-Kabirah   Palestine 18999 31.32 34.35       0</span>
<span class='c'>#&gt; 3       'Abdul Hakim    Pakistan 47788 30.55 72.11       0</span>
<span class='c'>#&gt; 4 'Abdullah-as-Salam      Kuwait 21817 29.36 47.98       0</span>
<span class='c'>#&gt; 5              'Abud   Palestine  2456 32.03 35.07       0</span>
<span class='c'>#&gt; 6            'Abwein   Palestine  3434 32.03 35.20       0</span>

<span class='nv'>my_cities</span> <span class='o'>&lt;-</span><span class='nf'>maps</span><span class='nf'>::</span><span class='nv'><a href='https://rdrr.io/pkg/maps/man/world.cities.html'>world.cities</a></span>

<span class='nv'>france_cities</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>my_cities</span>, <span class='nv'>country.etc</span> <span class='o'>==</span> <span class='s'>"France"</span><span class='o'>)</span>

<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>france_cities</span><span class='o'>)</span>

<span class='c'>#&gt;              name country.etc    pop   lat long capital</span>
<span class='c'>#&gt; 1       Abbeville      France  26656 50.12 1.83       0</span>
<span class='c'>#&gt; 2         Acheres      France  23219 48.97 2.06       0</span>
<span class='c'>#&gt; 3            Agde      France  23477 43.33 3.46       0</span>
<span class='c'>#&gt; 4            Agen      France  34742 44.20 0.62       0</span>
<span class='c'>#&gt; 5 Aire-sur-la-Lys      France  10470 50.64 2.39       0</span>
<span class='c'>#&gt; 6 Aix-en-Provence      France 148622 43.53 5.44       0</span>


<span class='c'># Make a point for every city:</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-27-2.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Let's pick just the big cities:</span>
<span class='nv'>france_big_cities</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>my_cities</span>,<span class='nv'>country.etc</span> <span class='o'>==</span> <span class='s'>"France"</span> <span class='o'>&amp;</span> <span class='nv'>pop</span> <span class='o'>&gt;</span> <span class='m'>100000</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france_big_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span><span class='o'>)</span><span class='o'>)</span> 

</code></pre>
<p><img src="figs/unnamed-chunk-28-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># vary size of point by city size</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>, mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france_big_cities</span>, color <span class='o'>=</span> <span class='s'>"red"</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, size <span class='o'>=</span> <span class='nv'>pop</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-29-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Now vary the color of the dots</span>
<span class='nv'>france_big_cities</span><span class='o'>$</span><span class='nv'>qual</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='o'>(</span><span class='nv'>LETTERS</span><span class='o'>[</span><span class='m'>1</span><span class='o'>:</span><span class='m'>5</span><span class='o'>]</span>,
                                 <span class='nf'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='o'>(</span><span class='nv'>france_big_cities</span><span class='o'>)</span>,
                                 replace <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span>

<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>,fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france_big_cities</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>, color <span class='o'>=</span> <span class='nv'>qual</span>, size <span class='o'>=</span> <span class='nv'>pop</span><span class='o'>)</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-30-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># Do some tweaking:</span>
<span class='c'># no scientific notation in legend r ggplot</span>
<span class='c'># scales package adds the "scale_size_continuous" function to our arsenal, and we can set label=comma</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://scales.r-lib.org'>scales</a></span><span class='o'>)</span>

<span class='c'># Change the column name to make the legend nicer:</span>
<span class='nv'>france_big_cities</span><span class='o'>$</span><span class='nv'>Population</span> <span class='o'>&lt;-</span> <span class='nv'>france_big_cities</span><span class='o'>$</span><span class='nv'>pop</span>
<span class='nv'>france_big_cities</span><span class='o'>$</span><span class='nv'>Qualitative</span> <span class='o'>&lt;-</span> <span class='nv'>france_big_cities</span><span class='o'>$</span><span class='nv'>qual</span>

<span class='c'># Do some additional refining:</span>
<span class='nf'>ggplot</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france</span>,
       mapping <span class='o'>=</span> <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='nv'>group</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_polygon</span><span class='o'>(</span>color <span class='o'>=</span> <span class='s'>"black"</span>, fill <span class='o'>=</span> <span class='s'>"white"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>geom_point</span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>france_big_cities</span>,
             <span class='nf'>aes</span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>long</span>, y <span class='o'>=</span> <span class='nv'>lat</span>, group <span class='o'>=</span> <span class='kc'>NULL</span>,
                 color <span class='o'>=</span> <span class='nv'>Qualitative</span>, size <span class='o'>=</span> <span class='nv'>Population</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'>scale_size_continuous</span><span class='o'>(</span>label <span class='o'>=</span> <span class='nv'>comma</span><span class='o'>)</span>

</code></pre>
<p><img src="figs/unnamed-chunk-31-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</details>
</div>

                    </div>

                    <br>

                    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://biodash.github.io/codeclub/11_ggplot-maps/&amp;text=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://biodash.github.io/codeclub/11_ggplot-maps/&amp;t=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2&amp;body=https://biodash.github.io/codeclub/11_ggplot-maps/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://biodash.github.io/codeclub/11_ggplot-maps/&amp;title=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2%20https://biodash.github.io/codeclub/11_ggplot-maps/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://biodash.github.io/codeclub/11_ggplot-maps/&amp;title=Session%2011:%20Spatial%20data%20visualization%20with%20ggplot2" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/authors/stephen-opiyo/"><img class="avatar mr-3 avatar-circle" src="/authors/stephen-opiyo/avatar_hu97f3077fdef19fd71aab353b93aaa071_254986_270x270_fill_q90_lanczos_center.jpg" alt="Stephen Opiyo"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/stephen-opiyo/">Stephen Opiyo</a></h5>
      <h6 class="card-subtitle">Biostatistician at MCIC</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:opiyo.1@osu.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/so13839" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















                    <br>

                    <hr class="separator">

                    <div class="clearfix">
                        
                        
                        <span class="previous-link">
                            <a href="https://biodash.github.io/codeclub/10_faceting-animating/">← Session 10: Faceting, multi-plots, and animating</a>
                        </span>
                        
                        
                        
                        
                        <span class="next-link">
                            <a href="https://biodash.github.io/codeclub/12_loops/">Session 12: Vectorization and loops in R →</a>
                        </span>
                        
                        
                    </div>

                    <hr class="separator">

                </div>

            </article>

            
        </main>
    </div>
</div>

  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
    
    <p class="powered-by">
      <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
    </p>
    
</footer>
    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
    
      <script async defer src="https://maps.googleapis.com/maps/api/js?key="></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
      
    
    <script src="/en/js/wowchemy.min.2f16af175a3ec51b41b36bb4934b1cf7.js"></script>

    






</body>
</html>
