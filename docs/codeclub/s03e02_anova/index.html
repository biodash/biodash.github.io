<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.0.0-beta.3 for Hugo" />
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jelmer Poelstra" />

  
  
  
    
  
  <meta name="description" content="During this session of Code Club, we will learn to run parametric and non-parametric ANOVA tests and use the output for creating plots with our statistical findings." />

  
  <link rel="alternate" hreflang="en-us" href="https://biodash.github.io/codeclub/s03e02_anova/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#3f51b5" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.80f9a276c6100914c616a06e45ba8d09.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F9CQ7P0DX"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-9F9CQ7P0DX', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hucc2cf774636a7e386557c89fa75ff618_191491_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="https://biodash.github.io/codeclub/s03e02_anova/" />

  
  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="BioDASH" />
  <meta property="og:url" content="https://biodash.github.io/codeclub/s03e02_anova/" />
  <meta property="og:title" content="S03E02: ANOVA | BioDASH" />
  <meta property="og:description" content="During this session of Code Club, we will learn to run parametric and non-parametric ANOVA tests and use the output for creating plots with our statistical findings." /><meta property="og:image" content="https://biodash.github.io/codeclub/s03e02_anova/featured.jpeg" />
    <meta property="twitter:image" content="https://biodash.github.io/codeclub/s03e02_anova/featured.jpeg" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-01-20T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-01-20T07:06:38-05:00">
  

  



  

  

  <link rel='stylesheet' href='/css/highlight-light.css' title='hl-light'>
<link rel='stylesheet' href='/css/highlight-dark.css' title='hl-dark' disabled>



  <title>S03E02: ANOVA | BioDASH</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="ccabb063df441de0c9d13a76508eafd4" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7a224883d792570fd34d30c7134eace3.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu6407506e646a281542ecb299640680ce_37988_0x70_resize_lanczos_2.png" alt="BioDASH"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Code Club</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/codeclub-schedule/"><span>- <b>Schedule</b></span></a>
            
              <a class="dropdown-item" href="/codeclub-schedule/#previous-semesters"><span>- Past Sessions</span></a>
            
              <a class="dropdown-item" href="/codeclub-setup/"><span>- Computer Setup</span></a>
            
              <a class="dropdown-item" href="/"><span>------------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-suggest/"><span>- Suggest a Topic</span></a>
            
              <a class="dropdown-item" href="/"><span>-----------------------</span></a>
            
              <a class="dropdown-item" href="/codeclub-about/"><span>- <b>About Code Club & Join Us!</b></span></a>
            
          </div>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Tutorials & Resources</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/events/2023-02_aws/"><span>AWS Workshop (Feb '23)</span></a>
            
              <a class="dropdown-item" href="/"><span>---------------------</span></a>
            
              <a class="dropdown-item" href="/tutorials/r-resources-tips/"><span>- R Resources and Tips</span></a>
            
              <a class="dropdown-item" href="/"><span>--------------------</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/2020-12-microbiomics-workshop/"><span>- Metabarcoding workshop (Fall '20)</span></a>
            
              <a class="dropdown-item" href="/tutorials/2021-01_rnaseq/"><span>- RNA-seq intro meetings (Spring '21)</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/pracs-sp21/"><span>- Computing Course (Spring '21)</span></a>
            
              <a class="dropdown-item" href="https://mcic-osu.github.io/cl-workshop-22/"><span>- Command-line, shell scripting and OSC Workshop (Summer '22)</span></a>
            
              <a class="dropdown-item" href="/tutorials/2023-04_aggenomics/presentation.html"><span>- Ag Genomics Lecture: Command-line computing (Apr '23)</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/support/"><span>Bioinformatics Support</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://github.com/biodash/biodash.github.io" target="_blank" rel="noopener"><i class='fab fa-github'></i><span></span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/index.xml" target="_blank" rel="noopener"><i class='fas fa-rss'></i><span></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      
        
      
        
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    
<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
        <div class="d-none d-xl-block col-xl-2 docs-toc">
            <ul class="nav toc-top">
                <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
            </ul>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#prep-homework">Prep homework</a>
      <ul>
        <li><a href="#basic-computer-setup">Basic computer setup</a></li>
        <li><a href="#new-to-ggplot">New to ggplot?</a></li>
        <li><a href="#adding-statistics-to-plots">Adding statistics to plots</a></li>
        <li><a href="#we-already-did-t-tests">We already did t-tests</a></li>
      </ul>
    </li>
    <li><a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#rmarkdown-for-today">RMarkdown for today</a></li>
        <li><a href="#introduction">Introduction</a></li>
      </ul>
    </li>
    <li><a href="#1---getting-acclimated">1 - Getting acclimated</a></li>
    <li><a href="#2-anova-function">2. ANOVA function</a></li>
    <li><a href="#3-posthoc-group-analysis">3. Posthoc group analysis</a></li>
    <li><a href="#4-bringing-it-together-in-a-plot">4. Bringing it together in a plot</a></li>
    <li><a href="#breakout-rooms">Breakout rooms</a>
      <ul>
        <li><a href="#exercise-1">Exercise 1</a></li>
        <li><a href="#exercise-2">Exercise 2</a></li>
        <li><a href="#exercise-3">Exercise 3</a></li>
      </ul>
    </li>
    <li><a href="#extra-material">Extra material</a>
      <ul>
        <li></li>
        <li><a href="#extra-exercise-1">Extra exercise 1</a></li>
        <li><a href="#extra-exercise-2">Extra exercise 2</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        <main class="col-12 col-md-0 col-xl-10 py-md-3 pl-md-5 docs-content" role="main">
            

            <article class="article">

                




















  
  
    
  


<div class="article-container pt-3">
  <h1>S03E02: ANOVA</h1>

  
  <p class="page-subtitle">Running ANOVAs, utilizing the R output, and 🐧</p>
  

  



<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      <a href="/authors/jessica-cooperstone/">Jessica Cooperstone</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
    Jan 20, 2022
  </span>
  

  

  

  
  
  
  
  

  
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 405px;">
  <div style="position: relative">
    <img src="/codeclub/s03e02_anova/featured_hua74af901d7485168e9b2819a5f7ffe89_1302058_720x0_resize_q90_lanczos.jpeg" alt="" class="featured-image">
    <span class="article-header-caption">Artwork by @allison_horst</span>
  </div>
</div>



                <div class="article-container">
                    <div class="article-style">
                        <hr>
<h2 id="prep-homework">Prep homework</h2>
<h3 id="basic-computer-setup">Basic computer setup</h3>
<ul>
<li>
<p>If you didn&rsquo;t already do this, please follow the <a href="/codeclub-setup/04_ggplot2/">Code Club Computer Setup</a> instructions, which also has pointers for if you&rsquo;re new to R or RStudio.</p>
</li>
<li>
<p>If you&rsquo;re able to do so, please open RStudio a bit before Code Club starts &ndash; and in case you run into issues, please join the Zoom call early and we&rsquo;ll help you troubleshoot.</p>
</li>
</ul>
<h3 id="new-to-ggplot">New to ggplot?</h3>
<p>This isn&rsquo;t a ggplot specific session, though we will be using it a bit. Check out the past Code Club sessions covering <code>ggplot2</code>:</p>
<ul>
<li><a href="/codeclub/04_ggplot2/">S01E04</a>: intro to ggplot2</li>
<li><a href="/codeclub/05_ggplot-round-2/">S01E05</a>: intro to ggplot2 round 2</li>
<li><a href="/codeclub/10_faceting-animating/">S01E10</a>: faceting and animating</li>
<li><a href="/codeclub/s02e06_ggplot2/">S02E06</a>: another intro to ggplot2</li>
<li><a href="/codeclub/s02e07_ggplot2_part2/">S02E07</a>: a second intro to ggplot2 round 2</li>
<li><a href="/codeclub/s02e08_multiple_plots/">S02E08</a>: combining plots using faceting</li>
<li><a href="/codeclub/s02e09_multiple_plots_part2/">S02E09</a>: combining plots using faceting and patchwork</li>
<li><a href="/codeclub/s02e10_ggpubr/">S02E10</a>: adding statistics to plots</li>
<li><a href="/codeclub/s02e12_plotly/">S02E11</a>: making interactive plots with plotly</li>
</ul>
<p>If you&rsquo;ve never used <code>ggplot2</code> before (or even if you have), you may find <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" target="_blank" rel="noopener">this cheat sheet</a> useful.</p>
<h3 id="adding-statistics-to-plots">Adding statistics to plots</h3>
<p>We had a previous session <a href="/codeclub/s02e10_ggpubr/">S02E10</a> developed by Daniel Quiroz that covers the package <code>ggpubr</code> and adding statistics to ggplots.</p>
<h3 id="we-already-did-t-tests">We already did t-tests</h3>
<p>Mike Sovic covered in the last code club <a href="/codeclub/s03e01_ttests/">S03E01</a> how to run t-tests in R. We will be building on what we learned last week.</p>
<br>
<h2 id="getting-started">Getting Started</h2>
<details>
<summary>
Click here to get an Rmd (optional)
</summary>
<h3 id="rmarkdown-for-today">RMarkdown for today</h3>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># directory </span>
<span class='nf'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='o'>(</span><span class='s'>"S03E02"</span><span class='o'>)</span>

<span class='c'># directory for our RMarkdown</span>
<span class='c'># ("recursive" to create two levels at once.)</span>
<span class='nf'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='o'>(</span><span class='s'>"S03E02/Rmd/"</span><span class='o'>)</span>

<span class='c'># save the url location for today's script</span>
<span class='nv'>todays_Rmd</span> <span class='o'>&lt;-</span> 
  <span class='s'>"https://raw.githubusercontent.com/biodash/biodash.github.io/master/content/codeclub/S03E02_anova/anova.Rmd"</span>

<span class='c'># indicate the name of the new Rmd</span>
<span class='nv'>S03E02_Rmd</span> <span class='o'>&lt;-</span> <span class='s'>"S03E02/Rmd/S03E02_anova.Rmd"</span>

<span class='c'># go get that file! </span>
<span class='nf'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='o'>(</span>url <span class='o'>=</span> <span class='nv'>todays_Rmd</span>,
              destfile <span class='o'>=</span> <span class='nv'>S03E02_Rmd</span><span class='o'>)</span></code></pre>
</div>
</details>
<br>
<div>
<br>
<hr>
<h3 id="introduction">Introduction</h3>
<p>Often people are first introduced to the R programming language when they are wanting to conduct statistical analyses. My experience is that beginners are often able to conduct the analysis they want, and print their results to the console. But, the process of locating and then using the output of their analysis tends to be more complex.</p>
<p>Today, we are going to go over how to:</p>
<ul>
<li>test if our data is suitable for running ANOVA</li>
<li>run an ANOVA test</li>
<li>run posthoc tests to understand group differences</li>
<li>use the ANOVA data output object as a means to understand R data structure.</li>
</ul>
<p>The purpose of today&rsquo;s session is more to give you practical experience with running and retrieving ANOVA analysis output, than teaching about the assumptions and background of the test itself.</p>
<p>If you are looking for a good statistics class, I would recommend Dr. Kristin Mercer&rsquo;s <a href="https://hcs.osu.edu/courses/hcs-8887" target="_blank" rel="noopener">HCS 8887 Experimental Design</a>.</p>
<br>
<hr>
<h4 id="--load-libraries-get-data">- Load libraries, get data</h4>
<p>We are going to start with our favorite dataset <code>palmerpenguins</code> to provide the input data for our analysis.</p>
<p>If you don&rsquo;t have any of the packages below, use <a href="https://rdrr.io/r/utils/install.packages.html" target="_blank" rel="noopener"><code>install.packages()</code></a> to download them.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='o'>)</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://allisonhorst.github.io/palmerpenguins/'>palmerpenguins</a></span><span class='o'>)</span> <span class='c'># for data</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://rpkgs.datanovia.com/rstatix/'>rstatix</a></span><span class='o'>)</span> <span class='c'># for testing assumptions</span>
<span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'>agricolae</span><span class='o'>)</span> <span class='c'># for post-hoc comparison of groups</span></code></pre>
</div>
<br>
<hr>
<h2 id="1---getting-acclimated">1 - Getting acclimated</h2>
<p>Some words on syntax: the dataset <code>penguins</code> is an object within the <code>palmerpenguins</code> package. If you call the object <code>penguins</code> (after executing <a href="https://allisonhorst.github.io/palmerpenguins/" target="_blank" rel="noopener"><code>library(palmerpenguins)</code></a>), you will be able to see what is contained within that dataframe.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 344 × 8</span></span>
<span class='c'>#&gt;    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span>
<span class='c'>#&gt;    <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>              <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>         <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>             <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span>       <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 1</span> Adelie  Torgersen           39.1          18.7               181        <span style='text-decoration: underline;'>3</span>750</span>
<span class='c'>#&gt; <span style='color: #555555;'> 2</span> Adelie  Torgersen           39.5          17.4               186        <span style='text-decoration: underline;'>3</span>800</span>
<span class='c'>#&gt; <span style='color: #555555;'> 3</span> Adelie  Torgersen           40.3          18                 195        <span style='text-decoration: underline;'>3</span>250</span>
<span class='c'>#&gt; <span style='color: #555555;'> 4</span> Adelie  Torgersen           <span style='color: #BB0000;'>NA</span>            <span style='color: #BB0000;'>NA</span>                  <span style='color: #BB0000;'>NA</span>          <span style='color: #BB0000;'>NA</span></span>
<span class='c'>#&gt; <span style='color: #555555;'> 5</span> Adelie  Torgersen           36.7          19.3               193        <span style='text-decoration: underline;'>3</span>450</span>
<span class='c'>#&gt; <span style='color: #555555;'> 6</span> Adelie  Torgersen           39.3          20.6               190        <span style='text-decoration: underline;'>3</span>650</span>
<span class='c'>#&gt; <span style='color: #555555;'> 7</span> Adelie  Torgersen           38.9          17.8               181        <span style='text-decoration: underline;'>3</span>625</span>
<span class='c'>#&gt; <span style='color: #555555;'> 8</span> Adelie  Torgersen           39.2          19.6               195        <span style='text-decoration: underline;'>4</span>675</span>
<span class='c'>#&gt; <span style='color: #555555;'> 9</span> Adelie  Torgersen           34.1          18.1               193        <span style='text-decoration: underline;'>3</span>475</span>
<span class='c'>#&gt; <span style='color: #555555;'>10</span> Adelie  Torgersen           42            20.2               190        <span style='text-decoration: underline;'>4</span>250</span>
<span class='c'>#&gt; <span style='color: #555555;'># … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span></code></pre>
</div>
<p>However, <code>penguins</code> will not be in your environment tab because it is not in your local environment. You can use it without it being in your local environment, but if you are bothered by this, you can save a copy in your local environment such it shows up in that top right pane.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span></code></pre>
</div>
<p>What is within this dataset?</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='o'>(</span><span class='nv'>penguins</span><span class='o'>)</span>
<span class='c'>#&gt; Rows: 344</span>
<span class='c'>#&gt; Columns: 8</span>
<span class='c'>#&gt; $ species           <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…</span>
<span class='c'>#&gt; $ island            <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…</span>
<span class='c'>#&gt; $ bill_length_mm    <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …</span>
<span class='c'>#&gt; $ bill_depth_mm     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …</span>
<span class='c'>#&gt; $ flipper_length_mm <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…</span>
<span class='c'>#&gt; $ body_mass_g       <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …</span>
<span class='c'>#&gt; $ sex               <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span> male, female, female, NA, female, male, female, male…</span>
<span class='c'>#&gt; $ year              <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</span></code></pre>
</div>
<p align="center">
<img src=palmerpenguins_hex.png width="30%" alt="a cute hexagon image of three penguins as a part of the palmer penguins package">
</p>
<p>Illustration by <a href="https://allisonhorst.github.io/palmerpenguins/articles/art.html" target="_blank" rel="noopener">Allison Horst</a></p>
<br>
<hr>
<h2 id="2-anova-function">2. ANOVA function</h2>
<p>We want to see if there are any differences in bill length (<code>bill_length_mm</code>) in penguins by <code>sex</code>, by <code>species</code>, or by their interaction. We do this using ANOVA.</p>
<p align="center">
<img src=lter_penguins.png width="50%" alt="a cute image of three penguins, the species adelie, chinstrap, and gentoo as a part of the palmer penguins package">
</p>
<p>Illustration by <a href="https://allisonhorst.github.io/palmerpenguins/articles/art.html" target="_blank" rel="noopener">Allison Horst</a></p>
<p>First let&rsquo;s get some descriptive information about our data.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='o'>(</span><span class='nv'>species</span>, <span class='nv'>sex</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='o'>(</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 6 × 3</span></span>
<span class='c'>#&gt; <span style='color: #555555;'># Groups:   species, sex [6]</span></span>
<span class='c'>#&gt;   species   sex        n</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie    female    73</span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Adelie    male      73</span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Chinstrap female    34</span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span> Chinstrap male      34</span>
<span class='c'>#&gt; <span style='color: #555555;'>5</span> Gentoo    female    58</span>
<span class='c'>#&gt; <span style='color: #555555;'>6</span> Gentoo    male      61</span></code></pre>
</div>
<p>The most commonly used function to run ANOVA in R is called <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/aov" target="_blank" rel="noopener"><code>aov()</code></a> which is a part of the <code>stats</code> package that is pre-loaded with base R. So no new packages need to be installed here.</p>
<p>If we want to learn more about the function <a href="https://rdrr.io/r/stats/aov.html" target="_blank" rel="noopener"><code>aov()</code></a> we can do so using the code below. The help documentation will show up in the bottom right quadrant of your RStudio.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='o'>?</span><span class='nf'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span><span class='o'>(</span><span class='o'>)</span></code></pre>
</div>
<p>We can run an ANOVA by indicating our model, and here I&rsquo;m also selecting to drop the NAs.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_length_anova</span> <span class='o'>&lt;-</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span>,
      <span class='nv'>bill_length_mm</span> <span class='o'>~</span> <span class='nv'>species</span> <span class='o'>+</span> <span class='nv'>sex</span> <span class='o'>+</span> <span class='nv'>species</span><span class='o'>*</span><span class='nv'>sex</span><span class='o'>)</span></code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='o'>(</span><span class='nv'>bill_length_anova</span><span class='o'>)</span>
<span class='c'>#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class='c'>#&gt; species       2   7015    3508 654.189 &lt;2e-16 ***</span>
<span class='c'>#&gt; sex           1   1136    1136 211.807 &lt;2e-16 ***</span>
<span class='c'>#&gt; species:sex   2     24      12   2.284  0.103    </span>
<span class='c'>#&gt; Residuals   327   1753       5                   </span>
<span class='c'>#&gt; ---</span>
<span class='c'>#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre>
</div>
<p align="center">
<img src=broom_package.png width="70%" alt="an image of fuzzy monsters with the test broom: turns messy tables into tidy tibbles. the monsters going in are ragged and dirty, they get cleaned and come out sparkling ">
</p>
<p>Illustration by <a href="https://github.com/allisonhorst/stats-illustrations" target="_blank" rel="noopener">Allison Horst</a></p>
<p>We can take the output of our ANOVA and use the function <a href="https://generics.r-lib.org/reference/tidy.html" target="_blank" rel="noopener"><code>tidy()</code></a> within the <code>broom</code> package to turn our output into a tidy table. Here, the notation <a href="https://generics.r-lib.org/reference/tidy.html" target="_blank" rel="noopener"><code>broom::tidy()</code></a> means I want to use the function <a href="https://generics.r-lib.org/reference/tidy.html" target="_blank" rel="noopener"><code>tidy()</code></a> that is a part of the <code>broom</code> package. This works even though I haven&rsquo;t called <a href="https://broom.tidymodels.org/" target="_blank" rel="noopener"><code>library(broom)</code></a> at the beginning of my script.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>tidy_anova</span> <span class='o'>&lt;-</span> <span class='nf'>broom</span><span class='nf'>::</span><span class='nf'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='o'>(</span><span class='nv'>bill_length_anova</span><span class='o'>)</span>

<span class='nf'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='o'>(</span><span class='nv'>tidy_anova</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 4 × 6</span></span>
<span class='c'>#&gt;   term           df  sumsq  meansq statistic    p.value</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>       <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>      <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> species         2 <span style='text-decoration: underline;'>7</span>015.  <span style='text-decoration: underline;'>3</span>508.      654.    5.03<span style='color: #555555;'>e</span><span style='color: #BB0000;'>-115</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> sex             1 <span style='text-decoration: underline;'>1</span>136.  <span style='text-decoration: underline;'>1</span>136.      212.    2.42<span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 37</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> species:sex     2   24.5   12.2       2.28  1.03<span style='color: #555555;'>e</span><span style='color: #BB0000;'>-  1</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span> Residuals     327 <span style='text-decoration: underline;'>1</span>753.     5.36     <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span>   <span style='color: #555555;'> </span></span></code></pre>
</div>
<p>We can also look at our data by visually plotting it, as below.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='o'>(</span><span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>, y <span class='o'>=</span> <span class='nv'>bill_length_mm</span>, color <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-11-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h2 id="3-posthoc-group-analysis">3. Posthoc group analysis</h2>
<p>Now that we&rsquo;ve seen that <code>sex</code> and <code>species</code> are significant effectors of <code>bill_length_mm</code>, our next logical question might be, which groups are different from each other? We can determine this by conducting post-hoc tests. We will do our post-hoc analysis using Tukey&rsquo;s Honestly Significant Difference test and the function <a href="https://www.rdocumentation.org/packages/agricolae/versions/1.3-5/topics/HSD.test" target="_blank" rel="noopener"><code>HSD.test()</code></a> which is a part of the useful package <code>agricolae</code>.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>tukey_bill_length</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/pkg/agricolae/man/HSD.test.html'>HSD.test</a></span><span class='o'>(</span><span class='nv'>bill_length_anova</span>, 
                      trt <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"species"</span>, <span class='s'>"sex"</span><span class='o'>)</span>, 
                      console <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span> <span class='c'># prints the results to console</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Study: bill_length_anova ~ c("species", "sex")</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; HSD Test for bill_length_mm </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Mean Square Error:  5.361892 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; species:sex,  means</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;                  bill_length_mm      std  r  Min  Max</span>
<span class='c'>#&gt; Adelie:female          37.25753 2.028883 73 32.1 42.2</span>
<span class='c'>#&gt; Adelie:male            40.39041 2.277131 73 34.6 46.0</span>
<span class='c'>#&gt; Chinstrap:female       46.57353 3.108669 34 40.9 58.0</span>
<span class='c'>#&gt; Chinstrap:male         51.09412 1.564558 34 48.5 55.8</span>
<span class='c'>#&gt; Gentoo:female          45.56379 2.051247 58 40.9 50.5</span>
<span class='c'>#&gt; Gentoo:male            49.47377 2.720594 61 44.4 59.6</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Alpha: 0.05 ; DF Error: 327 </span>
<span class='c'>#&gt; Critical Value of Studentized Range: 4.054126 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Groups according to probability of means differences and alpha level( 0.05 )</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Treatments with the same letter are not significantly different.</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;                  bill_length_mm groups</span>
<span class='c'>#&gt; Chinstrap:male         51.09412      a</span>
<span class='c'>#&gt; Gentoo:male            49.47377      b</span>
<span class='c'>#&gt; Chinstrap:female       46.57353      c</span>
<span class='c'>#&gt; Gentoo:female          45.56379      c</span>
<span class='c'>#&gt; Adelie:male            40.39041      d</span>
<span class='c'>#&gt; Adelie:female          37.25753      e</span></code></pre>
</div>
<p>Like we did with t-tests, you can also look at the resulting HSD.test object (here, <code>tukey_bill_length</code>) in your environment pane.</p>
<p>Here, instead of using the <code>broom</code> package, you can convert the part of the <code>tukey_bill_length</code> object that contains the post-hoc groupings into a dataframe using <a href="https://rdrr.io/r/base/as.data.frame.html" target="_blank" rel="noopener"><code>as.data.frame()</code></a>.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>tidy_tukey</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='o'>(</span><span class='nv'>tukey_bill_length</span><span class='o'>$</span><span class='nv'>groups</span><span class='o'>)</span>

<span class='nv'>tidy_tukey</span>
<span class='c'>#&gt;                  bill_length_mm groups</span>
<span class='c'>#&gt; Chinstrap:male         51.09412      a</span>
<span class='c'>#&gt; Gentoo:male            49.47377      b</span>
<span class='c'>#&gt; Chinstrap:female       46.57353      c</span>
<span class='c'>#&gt; Gentoo:female          45.56379      c</span>
<span class='c'>#&gt; Adelie:male            40.39041      d</span>
<span class='c'>#&gt; Adelie:female          37.25753      e</span></code></pre>
</div>
<br>
<hr>
<h2 id="4-bringing-it-together-in-a-plot">4. Bringing it together in a plot</h2>
<p>We already looked at a first-pass plot, but let&rsquo;s customize it now, and add our statistical info. Here is our base plot.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='o'>(</span><span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>, y <span class='o'>=</span> <span class='nv'>bill_length_mm</span>, color <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='o'>(</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-14-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>First let&rsquo;s make the plot more aesthetically pleasing.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='o'>(</span><span class='nv'>bill_length_plot</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='o'>(</span><span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>, y <span class='o'>=</span> <span class='nv'>bill_length_mm</span>, color <span class='o'>=</span> <span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='s'>"Species"</span>,
       y <span class='o'>=</span> <span class='s'>"Bill Length, in mm"</span>,
       color <span class='o'>=</span> <span class='s'>"Sex"</span>,
       title <span class='o'>=</span> <span class='s'>"Penguin Culmen Bill Length Among Different Species, and by Sex"</span>,
       subtitle <span class='o'>=</span> <span class='s'>"Data collected from Palmer LTER, Antarctica"</span><span class='o'>)</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-15-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>We want to add the letters to this plot, so we can tell which groups of species by sex are significantly different. We are going to figure out what the maximum <code>bill_length_mm</code> for each species by sex is, so it will help us determine where to put our letter labels. Then, we can add our labels to be higher than the largest data point.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_length_max</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='o'>(</span><span class='nv'>species</span>, <span class='nv'>sex</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='o'>(</span>max_bill_length_mm <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>bill_length_mm</span><span class='o'>)</span><span class='o'>)</span>
<span class='c'>#&gt; `summarise()` has grouped output by 'species'. You can override using the `.groups` argument.</span>

<span class='nv'>bill_length_max</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 6 × 3</span></span>
<span class='c'>#&gt; <span style='color: #555555;'># Groups:   species [3]</span></span>
<span class='c'>#&gt;   species   sex    max_bill_length_mm</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>               <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie    female               42.2</span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Adelie    male                 46  </span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Chinstrap female               58  </span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span> Chinstrap male                 55.8</span>
<span class='c'>#&gt; <span style='color: #555555;'>5</span> Gentoo    female               50.5</span>
<span class='c'>#&gt; <span style='color: #555555;'>6</span> Gentoo    male                 59.6</span></code></pre>
</div>
<p>Let&rsquo;s add our post-hoc group info to <code>bill_length_max</code>, since those two dataframes are not in the same order. We are going to use the function <a href="https://tidyr.tidyverse.org/reference/separate.html" target="_blank" rel="noopener"><code>separate()</code></a> which we used back in a <a href="https://biodash.github.io/codeclub/20_cleaning-up/#5---separate-character-columns" target="_blank" rel="noopener">previous code club</a>.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>tidier_tukey</span> <span class='o'>&lt;-</span> <span class='nv'>tidy_tukey</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames_to_column</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='o'>(</span>col <span class='o'>=</span> <span class='nv'>rowname</span>,
           into <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"species"</span>, <span class='s'>"sex"</span><span class='o'>)</span>,
           sep <span class='o'>=</span> <span class='s'>":"</span><span class='o'>)</span>
  

<span class='nv'>bill_for_plotting</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='o'>(</span><span class='nv'>tidier_tukey</span>, <span class='nv'>bill_length_max</span>,
                               by <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='o'>(</span><span class='s'>"species"</span>, <span class='s'>"sex"</span><span class='o'>)</span><span class='o'>)</span></code></pre>
</div>
<p>Let&rsquo;s plot.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_length_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>bill_for_plotting</span>,
            <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>,
                y <span class='o'>=</span> <span class='m'>5</span> <span class='o'>+</span> <span class='nv'>max_bill_length_mm</span>, 
                color <span class='o'>=</span> <span class='nv'>sex</span>,
                label <span class='o'>=</span> <span class='nv'>groups</span><span class='o'>)</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-18-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>Almost there. We want the letters to be over the right box plot (coloring here by <code>sex</code> helps us to see what is going on better). Let&rsquo;s fix it.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_length_plot</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>bill_for_plotting</span>,
            <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>,
                y <span class='o'>=</span> <span class='m'>3</span> <span class='o'>+</span> <span class='nv'>max_bill_length_mm</span>, 
                color <span class='o'>=</span> <span class='nv'>sex</span>,
                label <span class='o'>=</span> <span class='nv'>groups</span><span class='o'>)</span>,
            position <span class='o'>=</span> <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='o'>(</span>width <span class='o'>=</span> <span class='m'>0.75</span><span class='o'>)</span>,
            show.legend <span class='o'>=</span> <span class='kc'>FALSE</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='o'>(</span>caption <span class='o'>=</span> <span class='s'>"Groups with different letters are statistically different using a\n two way ANOVA and Tukey's post-hoc test"</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-19-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<p>Also remember Daniel showed us how we can do <a href="https://biodash.github.io/codeclub/s02e10_ggpubr/" target="_blank" rel="noopener">somthing similar</a> using the package <code>ggpubr</code>.</p>
<br>
<hr>
<h2 id="breakout-rooms">Breakout rooms</h2>
<p>We have investigated <code>bill_length_mm</code> - but what about <code>bill_depth_mm</code>? Let&rsquo;s investigate only the male penguins.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='kr'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='o'>(</span><span class='nv'><a href='https://allisonhorst.github.io/palmerpenguins/'>palmerpenguins</a></span><span class='o'>)</span>

<span class='nf'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='o'>(</span><span class='nv'>penguins</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 6 × 8</span></span>
<span class='c'>#&gt;   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  </span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>           <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>         <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>            <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span>       <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie  Torge…           39.1          18.7              181        <span style='text-decoration: underline;'>3</span>750 male </span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Adelie  Torge…           39.5          17.4              186        <span style='text-decoration: underline;'>3</span>800 fema…</span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Adelie  Torge…           40.3          18                195        <span style='text-decoration: underline;'>3</span>250 fema…</span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span> Adelie  Torge…           <span style='color: #BB0000;'>NA</span>            <span style='color: #BB0000;'>NA</span>                 <span style='color: #BB0000;'>NA</span>          <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>   </span>
<span class='c'>#&gt; <span style='color: #555555;'>5</span> Adelie  Torge…           36.7          19.3              193        <span style='text-decoration: underline;'>3</span>450 fema…</span>
<span class='c'>#&gt; <span style='color: #555555;'>6</span> Adelie  Torge…           39.3          20.6              190        <span style='text-decoration: underline;'>3</span>650 male </span>
<span class='c'>#&gt; <span style='color: #555555;'># … with 1 more variable: year &lt;int&gt;</span></span></code></pre>
</div>
<h3 id="exercise-1">Exercise 1</h3>
<div class="puzzle">
<div>
<p>Conduct an ANOVA to see if there are significant differences in <code>bill_depth_mm</code> in the Palmer penguins by by <code>species</code>.</p>
<details>
<summary>
Hints (click here)
</summary>
Use the function [`aov()`](https://rdrr.io/r/stats/aov.html). Make sure you provide a model formula. <br>
</details>
<br>
<details>
<summary>
Solutions (click here)
</summary>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_depth_anova</span> <span class='o'>&lt;-</span> 
  <span class='nf'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span>,
      <span class='nv'>bill_depth_mm</span> <span class='o'>~</span> <span class='nv'>species</span><span class='o'>)</span>

<span class='nf'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='o'>(</span><span class='nv'>bill_depth_anova</span><span class='o'>)</span>
<span class='c'>#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class='c'>#&gt; species       2  453.0  226.51   294.7 &lt;2e-16 ***</span>
<span class='c'>#&gt; Residuals   165  126.8    0.77                   </span>
<span class='c'>#&gt; ---</span>
<span class='c'>#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre>
</div>
</details>
<br>
</div>
</div>
<hr>
<h3 id="exercise-2">Exercise 2</h3>
<div class="puzzle">
<div>
<p>Conduct post-hoc tests to see where significant differences exist between your <code>species</code>. You can use any post-hoc test you like.</p>
<details>
<summary>
Hints (click here)
</summary>
Check out the function [`LSD.test`](https://www.rdocumentation.org/packages/agricolae/versions/1.3-5/topics/LSD.test) and the p-value adjustment procedures. <br>
</details>
<br>
<details>
<summary>
Solutions (click here)
</summary>
Using a Bonferroni correction  
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bonferroni_bill_depth</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/pkg/agricolae/man/LSD.test.html'>LSD.test</a></span><span class='o'>(</span><span class='nv'>bill_depth_anova</span>, 
                      trt <span class='o'>=</span> <span class='s'>"species"</span>, 
                      p.adj <span class='o'>=</span> <span class='s'>"bonferroni"</span>,
                      console <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Study: bill_depth_anova ~ "species"</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; LSD t Test for bill_depth_mm </span>
<span class='c'>#&gt; P value adjustment method: bonferroni </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Mean Square Error:  0.7686065 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; species,  means and individual ( 95 %) CI</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;           bill_depth_mm       std  r      LCL      UCL  Min  Max</span>
<span class='c'>#&gt; Adelie         19.07260 1.0188856 73 18.87000 19.27520 17.0 21.5</span>
<span class='c'>#&gt; Chinstrap      19.25294 0.7612730 34 18.95608 19.54981 17.5 20.8</span>
<span class='c'>#&gt; Gentoo         15.71803 0.7410596 61 15.49640 15.93966 14.1 17.3</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Alpha: 0.05 ; DF Error: 165</span>
<span class='c'>#&gt; Critical Value of t: 2.418634 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Groups according to probability of means differences and alpha level( 0.05 )</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Treatments with the same letter are not significantly different.</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;           bill_depth_mm groups</span>
<span class='c'>#&gt; Chinstrap      19.25294      a</span>
<span class='c'>#&gt; Adelie         19.07260      a</span>
<span class='c'>#&gt; Gentoo         15.71803      b</span></code></pre>
</div>
<p>Using Tukey&rsquo;s posthoc test</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>tukey_bill_length</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/pkg/agricolae/man/HSD.test.html'>HSD.test</a></span><span class='o'>(</span><span class='nv'>bill_depth_anova</span>, 
                      trt <span class='o'>=</span> <span class='s'>"species"</span>, 
                      console <span class='o'>=</span> <span class='kc'>TRUE</span><span class='o'>)</span> <span class='c'># prints the results to console</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Study: bill_depth_anova ~ "species"</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; HSD Test for bill_depth_mm </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Mean Square Error:  0.7686065 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; species,  means</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;           bill_depth_mm       std  r  Min  Max</span>
<span class='c'>#&gt; Adelie         19.07260 1.0188856 73 17.0 21.5</span>
<span class='c'>#&gt; Chinstrap      19.25294 0.7612730 34 17.5 20.8</span>
<span class='c'>#&gt; Gentoo         15.71803 0.7410596 61 14.1 17.3</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Alpha: 0.05 ; DF Error: 165 </span>
<span class='c'>#&gt; Critical Value of Studentized Range: 3.344694 </span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Groups according to probability of means differences and alpha level( 0.05 )</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt; Treatments with the same letter are not significantly different.</span>
<span class='c'>#&gt; </span>
<span class='c'>#&gt;           bill_depth_mm groups</span>
<span class='c'>#&gt; Chinstrap      19.25294      a</span>
<span class='c'>#&gt; Adelie         19.07260      a</span>
<span class='c'>#&gt; Gentoo         15.71803      b</span></code></pre>
</div>
</details>
<br>
</div>
</div>
<hr>
<h3 id="exercise-3">Exercise 3</h3>
<div class="puzzle">
<div>
<p>Make a plot to express your findings. I will leave it up to you to decide what this plot will look like. Add your statistical findings.</p>
<details>
<summary>
Hints (click here)
</summary>
Review the information in section 4 of this post. You could also use the package `ggpubr`. <br>
</details>
<br>
<details>
<summary>
Solutions (click here)
</summary>
Preparing to plot.
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_depth_max</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='o'>(</span><span class='nv'>species</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='o'>(</span>max_bill_depth_mm <span class='o'>=</span> <span class='nf'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='o'>(</span><span class='nv'>bill_depth_mm</span><span class='o'>)</span><span class='o'>)</span>

<span class='nv'>bill_depth_max</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 3 × 2</span></span>
<span class='c'>#&gt;   species   max_bill_depth_mm</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>                 <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie                 21.5</span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Chinstrap              20.8</span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Gentoo                 17.3</span></code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='c'># grab group information from bonferroni test</span>
<span class='c'># species is a rowname instead of column so lets change that</span>
<span class='nv'>bonferroni_bill_depth_groups</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='o'>(</span><span class='nv'>bonferroni_bill_depth</span><span class='o'>$</span><span class='nv'>groups</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
                                                <span class='nf'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames_to_column</a></span><span class='o'>(</span>var <span class='o'>=</span> <span class='s'>"species"</span><span class='o'>)</span><span class='o'>)</span>

<span class='c'># join dfs</span>
<span class='nv'>bill_depth_for_plotting</span> <span class='o'>&lt;-</span> <span class='nf'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='o'>(</span><span class='nv'>bill_depth_max</span>, <span class='nv'>bonferroni_bill_depth_groups</span>,
                                     by <span class='o'>=</span> <span class='s'>"species"</span><span class='o'>)</span>

<span class='c'># check</span>
<span class='nv'>bill_depth_for_plotting</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 3 × 4</span></span>
<span class='c'>#&gt;   species   max_bill_depth_mm bill_depth_mm groups</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>                 <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>         <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span> </span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie                 21.5          19.1 a     </span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Chinstrap              20.8          19.3 a     </span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Gentoo                 17.3          15.7 b</span></code></pre>
</div>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='o'>(</span><span class='nv'>bill_depth_plot</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='o'>(</span><span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>, y <span class='o'>=</span> <span class='nv'>bill_depth_mm</span>, color <span class='o'>=</span> <span class='nv'>species</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='o'>(</span>outlier.shape <span class='o'>=</span> <span class='kc'>NA</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_jitter.html'>geom_jitter</a></span><span class='o'>(</span>width <span class='o'>=</span> <span class='m'>0.2</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>bill_depth_for_plotting</span>,
            <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>species</span>, y <span class='o'>=</span> <span class='m'>1</span> <span class='o'>+</span> <span class='nv'>max_bill_depth_mm</span>,
                label <span class='o'>=</span> <span class='nv'>groups</span><span class='o'>)</span>, color <span class='o'>=</span> <span class='s'>"black"</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span> 
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='o'>(</span>legend.position <span class='o'>=</span> <span class='s'>"none"</span>,
        plot.caption <span class='o'>=</span> <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='o'>(</span>hjust <span class='o'>=</span> <span class='m'>0</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='s'>"Species"</span>,
       y <span class='o'>=</span> <span class='s'>"Bill Depth, in mm"</span>,
       title <span class='o'>=</span> <span class='s'>"Penguin Culmen Bill Depth Among Different Species"</span>,
       subtitle <span class='o'>=</span> <span class='s'>"Data collected from Palmer LTER, Antarctica"</span>,
       caption <span class='o'>=</span> <span class='s'>"Species significantly affects bill depth as determined by one-way ANOVA \nwith significantly different species using Bonferroni post-hoc test at P &lt; 0.05 indicated with different letters."</span><span class='o'>)</span><span class='o'>)</span>
</code></pre>
<p><img src="figs/unnamed-chunk-26-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
</details>
<br>
</div>
</div>
<br>
<hr>
<h2 id="extra-material">Extra material</h2>
<p>This session was getting a bit long so I&rsquo;m putting a section about testing assumptions here. ### Testing assumptions</p>
<p>I know I said we weren&rsquo;t going to talk about this, but I thought I&rsquo;d be remiss if I didn&rsquo;t show you how to test that you aren&rsquo;t violating any of the assumptions needed to conduct an ANOVA. We went over this a little bit back in the session put together by Daniel Quiroz on <a href="https://biodash.github.io/codeclub/s02e10_ggpubr/" target="_blank" rel="noopener">ggpubr</a> and adding statistical results to ggplots.</p>
<p>Briefly, in order to use parametric procedures (like ANOVA), we need to be sure our data meets the assumptions for 1) normality and 2) constant variance. This can be done in a few different ways.</p>
<h4 id="shapiro-wilk-test-for-normality">Shapiro-Wilk test for normality</h4>
<p>We are going to use the Shapiro-Wilk test (using the function <a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html" target="_blank" rel="noopener"><code>shapiro_test()</code></a> which is in the package <code>rstatix</code> to determine normality, but will do it groupwise. This function is a pipe-friendly wrapper for the function <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/shapiro.test" target="_blank" rel="noopener"><code>shapiro.test()</code></a>, which just means you can use it with pipes.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'>rstatix</span><span class='nf'>::</span><span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html'>shapiro_test</a></span><span class='o'>(</span><span class='nv'>bill_length_mm</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 1 × 3</span></span>
<span class='c'>#&gt;   variable       statistic         p</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>              <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> bill_length_mm     0.974 0.000<span style='text-decoration: underline;'>011</span>9</span>

<span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='o'>(</span><span class='nv'>species</span>, <span class='nv'>sex</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'>rstatix</span><span class='nf'>::</span><span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html'>shapiro_test</a></span><span class='o'>(</span><span class='nv'>bill_length_mm</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 6 × 5</span></span>
<span class='c'>#&gt;   species   sex    variable       statistic       p</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>              <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie    female bill_length_mm     0.991 0.895  </span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Adelie    male   bill_length_mm     0.986 0.607  </span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Chinstrap female bill_length_mm     0.883 0.001<span style='text-decoration: underline;'>70</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>4</span> Chinstrap male   bill_length_mm     0.955 0.177  </span>
<span class='c'>#&gt; <span style='color: #555555;'>5</span> Gentoo    female bill_length_mm     0.989 0.895  </span>
<span class='c'>#&gt; <span style='color: #555555;'>6</span> Gentoo    male   bill_length_mm     0.940 0.005<span style='text-decoration: underline;'>11</span></span></code></pre>
</div>
<p>Can we visualize normality in another way?</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='o'>(</span><span class='nf'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='o'>(</span>x <span class='o'>=</span> <span class='nv'>bill_length_mm</span><span class='o'>)</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'>+</span>
  <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='o'>(</span>cols <span class='o'>=</span> <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='o'>(</span><span class='nv'>species</span><span class='o'>)</span>,
             rows <span class='o'>=</span> <span class='nf'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='o'>(</span><span class='nv'>sex</span><span class='o'>)</span><span class='o'>)</span>
<span class='c'>#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</code></pre>
<p><img src="figs/unnamed-chunk-28-1.png" width="700px" style="display: block; margin: auto;" /></p>
</div>
<h4 id="equal-variance">Equal variance</h4>
<p>We can test for equal variance using Levene&rsquo;s test, <a href="https://www.rdocumentation.org/packages/rstatix/versions/0.7.0/topics/levene_test" target="_blank" rel="noopener"><code>levene_test()</code></a> which is part of the <code>rstatix</code> package. Again, this is a pipe-friendly wrapper for the function <a href="https://www.rdocumentation.org/packages/lawstat/versions/3.4/topics/levene.test" target="_blank" rel="noopener"><code>levene.test()</code></a>.</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>rstatix</span><span class='nf'>::</span><span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/levene_test.html'>levene_test</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span>,
                       <span class='nv'>bill_length_mm</span> <span class='o'>~</span> <span class='nv'>species</span><span class='o'>*</span><span class='nv'>sex</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 1 × 4</span></span>
<span class='c'>#&gt;     df1   df2 statistic     p</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span>     5   327      1.40 0.222</span></code></pre>
</div>
<br>
<h3 id="extra-exercise-1">Extra exercise 1</h3>
<div class="puzzle">
<div>
<p>Test the assumptions used by ANOVA to see if it is an appropriate test for you to use in this case. If it is not, find out what the appropriate test to use is, and then use it!</p>
<details>
<summary>
Hints (click here)
</summary>
Test for normality and equal variance using [`shapiro_test()`](https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html) and [`levene_test()`](https://rpkgs.datanovia.com/rstatix/reference/levene_test.html) respectively. <br>
</details>
<br>
<details>
<summary>
Solutions (click here)
</summary>
Testing for normality:
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='o'>(</span><span class='nv'>species</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'>rstatix</span><span class='nf'>::</span><span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html'>shapiro_test</a></span><span class='o'>(</span><span class='nv'>bill_depth_mm</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 3 × 4</span></span>
<span class='c'>#&gt;   species   variable      statistic      p</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;fct&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>             <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> Adelie    bill_depth_mm     0.964 0.033<span style='text-decoration: underline;'>5</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>2</span> Chinstrap bill_depth_mm     0.983 0.863 </span>
<span class='c'>#&gt; <span style='color: #555555;'>3</span> Gentoo    bill_depth_mm     0.980 0.401</span></code></pre>
</div>
<p>Testing for equal variance:</p>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nf'>rstatix</span><span class='nf'>::</span><span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/levene_test.html'>levene_test</a></span><span class='o'>(</span>data <span class='o'>=</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span> <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span>,
                       <span class='nv'>bill_depth_mm</span> <span class='o'>~</span> <span class='nv'>species</span><span class='o'>*</span><span class='nv'>sex</span><span class='o'>)</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 1 × 4</span></span>
<span class='c'>#&gt;     df1   df2 statistic     p</span>
<span class='c'>#&gt;   <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span></span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span>     2   165      2.30 0.103</span></code></pre>
</div>
<p>We are finding non-normal distribution of the male, Adelie penguins. I will take this opportunity to show you how to run non-parametric tests as well.</p>
</details>
<br>
</div>
</div>
<hr>
<h3 id="extra-exercise-2">Extra exercise 2</h3>
<div class="puzzle">
<div>
<p>Conduct an non-parametric ANOVA to see if there are significant differences in <code>bill_depth_mm</code> in the Palmer penguins by by <code>species</code>.</p>
<details>
<summary>
Hints (click here)
</summary>
The non-parametric version of a one-way ANOVA is the Kruskal-Wallis test, and you can use the `rstatix` function [`kruskal_test()`](https://www.rdocumentation.org/packages/rstatix/versions/0.7.0/topics/kruskal_test). <br>
</details>
<br>
<details>
<summary>
Solutions (click here)
</summary>
<div class="highlight">
<pre class='chroma'><code class='language-r' data-lang='r'><span class='nv'>bill_depth_kruskal</span> <span class='o'>&lt;-</span> <span class='nv'>penguins</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='o'>(</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='o'>(</span><span class='nv'>sex</span> <span class='o'>==</span> <span class='s'>"male"</span><span class='o'>)</span> <span class='o'><a href='https://rpkgs.datanovia.com/rstatix/reference/pipe.html'>%&gt;%</a></span>
  <span class='nf'><a href='https://rpkgs.datanovia.com/rstatix/reference/kruskal_test.html'>kruskal_test</a></span><span class='o'>(</span><span class='nv'>bill_depth_mm</span> <span class='o'>~</span> <span class='nv'>species</span><span class='o'>)</span>

<span class='nv'>bill_depth_kruskal</span>
<span class='c'>#&gt; <span style='color: #555555;'># A tibble: 1 × 6</span></span>
<span class='c'>#&gt;   .y.               n statistic    df     p method        </span>
<span class='c'>#&gt; <span style='color: #555555;'>*</span> <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span>     <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;int&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #555555; font-style: italic;'>&lt;chr&gt;</span>         </span>
<span class='c'>#&gt; <span style='color: #555555;'>1</span> bill_depth_mm   168      116.     2 6<span style='color: #555555;'>e</span><span style='color: #BB0000;'>-26</span> Kruskal-Wallis</span></code></pre>
</div>
</details>
<br>
</div>
</div>
<hr>

                    </div>

                    <br>

                    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://biodash.github.io/codeclub/s03e02_anova/&amp;text=S03E02:%20ANOVA" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://biodash.github.io/codeclub/s03e02_anova/&amp;t=S03E02:%20ANOVA" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=S03E02:%20ANOVA&amp;body=https://biodash.github.io/codeclub/s03e02_anova/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://biodash.github.io/codeclub/s03e02_anova/&amp;title=S03E02:%20ANOVA" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=S03E02:%20ANOVA%20https://biodash.github.io/codeclub/s03e02_anova/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://biodash.github.io/codeclub/s03e02_anova/&amp;title=S03E02:%20ANOVA" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/authors/jessica-cooperstone/"><img class="avatar mr-3 avatar-circle" src="/authors/jessica-cooperstone/avatar_hub3c8c373219f94b7f8251ccae20f3fcb_68385_270x270_fill_q90_lanczos_center.jpg" alt="Jessica Cooperstone"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/jessica-cooperstone/">Jessica Cooperstone</a></h5>
      <h6 class="card-subtitle">Assistant Professor at HCS</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:cooperstone.1@osu.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/CooperstoneLab" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=d-FkQNQAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jcooperstone" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://phytochemicals.osu.edu/" target="_blank" rel="noopener">
        <i class="fas fa-external-link-alt"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















                    <br>

                    <hr class="separator">

                    <div class="clearfix">
                        
                        
                        <span class="previous-link">
                            <a href="https://biodash.github.io/codeclub/s03e01_ttests/">← Code Club S03E01: t-tests In R</a>
                        </span>
                        
                        
                        
                        
                        <span class="next-link">
                            <a href="https://biodash.github.io/codeclub/s03e04_anova2/">S03E04: ANOVA 2 →</a>
                        </span>
                        
                        
                    </div>

                    <hr class="separator">

                </div>

            </article>

            
        </main>
    </div>
</div>

  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
    
    <p class="powered-by">
      <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
    </p>
    
</footer>
    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
    
      <script async defer src="https://maps.googleapis.com/maps/api/js?key="></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
      
    
    <script src="/en/js/wowchemy.min.2f16af175a3ec51b41b36bb4934b1cf7.js"></script>

    






</body>
</html>
